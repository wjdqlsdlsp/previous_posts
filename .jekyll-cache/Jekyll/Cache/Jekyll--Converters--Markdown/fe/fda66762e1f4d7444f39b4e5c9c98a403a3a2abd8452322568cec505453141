I"ï^<h1 id="introduction-to-aws-boto-in-python">Introduction to AWS Boto in Python</h1>

<p>Â Â <br /></p>

<h2 id="putting-files-in-the-cloud">Putting Files in the Cloud!</h2>

<p>AWSëŠ” ì¸í„°ë„·ì˜ ì¤‘ì¶”ë¥¼ ë‹´ë‹¹í•˜ê³  ìˆê³ , Boto3ë¥¼ ì‚¬ìš©í•˜ë©´, laptopì˜ í™•ì¥ìœ¼ë¡œ ì‚¬ìš©í•  AWSì˜ ê¸°ëŠ¥ì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ( ìë™ ë³´ê³ ì„œ ì‘ì„±, ê°ì • ë¶„ì„ ìˆ˜í–‰, ì•Œë¦¼ ì „ì†¡ ë“± )</p>

<p>Pythonì—ì„œ AWSì™€ ìƒí˜¸ ì‘ìš©í•˜ê¸° ìœ„í•´ Boto3ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">boto3</span>

<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'s3'</span><span class="p">,</span>
                <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span> 

<span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">list_buckets</span><span class="p">()</span>
</code></pre></div></div>

<p>ì‚¬ìš©ë²•ì€ ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<p>ë¨¼ì € <code class="language-plaintext highlighter-rouge">boto3</code>ë¥¼ ì„ ì–¸í•˜ê³ , AWS ì„œë¹„ìŠ¤ ì´ë¦„, ë¦¬ì „, í‚¤ ë° ì‹œí¬ë¦¿ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ˆê¸°í™” í•©ë‹ˆë‹¤.</p>

<p align="center"><img src="/images/post_img/boto1.png" /></p>

<p>Boto3ì˜ í‚¤/ì‹œí¬ë¦¿ì„ ìƒì„±í•˜ê¸° ìœ„í•´ IAM(Identity Acess Management Service)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<h4 id="ê¶Œí•œ-ë¶€ì—¬-ë°©ë²•">ê¶Œí•œ ë¶€ì—¬ ë°©ë²•</h4>

<p align="center"><img src="/images/post_img/boto2.png" /></p>

<p>ì•„ë§ˆì¡´ IAM ì‚¬ìš©ìì— ë‹¤ìŒê³¼ ê°™ì€ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.</p>

<h4 id="aws-service">AWS service</h4>

<ul>
  <li>
    <p>IAM : ì´ì „ì— ì•Œì•„ë³¸ ê²ƒì²˜ëŸ¼ Identity Acess Management Service ì˜ ì•½ì–´ë¡œ, ê¶Œí•œë“±ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>S3 : Simple Storage Serviceë¡œ, íŒŒì¼ì„ í´ë¼ìš°ë“œì— ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>SNS : Simple Notification Seviceë¡œ, ì´ë©”ì¼ê³¼ ë¬¸ìë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì´ë¥¼ ì´ìš©í•˜ì—¬, ë°ì´í„° íŒŒì´í”„ ë¼ì¸ì˜ ì´ë²¤íŠ¸ ë° ì¡°ê±´ì„ ê¸°ë°˜ìœ¼ë¡œ ê°€ì…ìì—ê²Œ ê²½ê³ í•©ë‹ˆë‹¤.)</p>
  </li>
  <li>
    <p>Comprehend : í…ìŠ¤íŠ¸ ë¸”ë¡ì— ëŒ€í•œ ê°ì • ë¶„ì„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>Rekognition : ì´ë¯¸ì§€ì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•˜ê³  ì‚¬ì§„ì—ì„œ ê³ ì–‘ì´ë¥¼ ì°¾ìŠµë‹ˆë‹¤.</p>
  </li>
</ul>

<p><br /></p>

<h4 id="diving-into-buckets">Diving into buckets</h4>

<p>S3ë¥¼ ì‚¬ìš©í•˜ë©´, í´ë¼ìš°ë“œì— íŒŒì¼ì„ ë„£ê³ , URLì„ í†µí•´ ì „ ì„¸ê³„ ì–´ë””ì„œë‚˜ ì•¡ì„¸ìŠ¤ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>í´ë¼ìš°ë“œ ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬ëŠ” ë°ì´í„° íŒŒì´í”„ ë¼ì¸ì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="s3-components---buckets">S3 Components - Buckets</h4>

<p>S3ì˜ ì£¼ìš” êµ¬ì„± ìš”ì†ŒëŠ” ë²„í‚· ë° ê°ì²´ì…ë‹ˆë‹¤.</p>

<ul>
  <li>
    <p>ë²„í‚·ì€ ë°ìŠ¤í¬íƒ‘ì˜ í´ë”ì™€ ê°™ìŠµë‹ˆë‹¤. ( ê°ì²´ëŠ” í•´ë‹¹ í´ë” ë‚´ì˜ íŒŒì¼ê³¼ ê°™ìŠµë‹ˆë‹¤. )</p>
  </li>
  <li>
    <p>ë²„í‚·ì—ëŠ” ìì²´ ê¶Œí•œ ì •ì±…ì´ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>ì •ì  ì›¹ ì‚¬ì´íŠ¸ì˜ í´ë” ì—­í• ì„ í•˜ë„ë¡ êµ¬ì„± í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>ë¡œê·¸ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
</ul>

<p><br /></p>

<h4 id="s3-components---objects">S3 Components - Objects</h4>

<p>ë²„í‚·ì´ ìˆ˜í–‰í•˜ëŠ” ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ ê°ì²´ë¥¼ í¬í•¨í•˜ëŠ” ê²ƒ ì…ë‹ˆë‹¤.</p>

<p>ê°ì²´ëŠ” ì´ë¯¸ì§€, ë¹„ë””ì˜¤, íŒŒì¼, CSV, ë¡œê·¸ íŒŒì¼ë“œì‰ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="what-can-we-do-with-buckets">What can we do with buckets?</h4>

<ul>
  <li>
    <p>ë²„í‚·ì„ ìƒì„±</p>
  </li>
  <li>
    <p>ë²„í‚·ì„ ë‚˜ì—´</p>
  </li>
  <li>
    <p>ë²„í‚·ì„ ì‚­ì œ</p>
  </li>
</ul>

<p><br /></p>

<h4 id="ë²„í‚·-ìƒì„±">ë²„í‚· ìƒì„±</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">boto3</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'s3'</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                        <span class="n">aws_acess_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">create_bucket</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span> <span class="p">)</span>
</code></pre></div></div>

<p>ì´ì „ê³¼ ë™ì¼í•˜ê²Œ, í´ë¼ì´ì–¸íŠ¸ë¥¼ ìƒì„±í•œ ë’¤, gid-requests ë²„ì¼“ì„ ìƒì„±í•©ë‹ˆë‹¤.  (ë²„í‚·ì„ ìƒì„±í•  ë•Œ, ë²„í‚·ì˜ ì´ë¦„ì€ ëª¨ë‘ ê³ ìœ í•´ì•¼í•©ë‹ˆë‹¤. ì•ˆê·¸ëŸ¬ë©´ ì˜¤ë¥˜ ìƒê¹ë‹ˆë‹¤.)</p>

<p><br /></p>

<h4 id="ë²„í‚·-ë‚˜ì—´">ë²„í‚· ë‚˜ì—´</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">boto3</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'s3'</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                        <span class="n">aws_acess_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>
<span class="n">bucket_response</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">list_buckets</span><span class="p">()</span>
<span class="n">buckets</span> <span class="o">=</span> <span class="n">bucket_response</span><span class="p">[</span><span class="s">'Buckets'</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">buckets</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="ë²„í‚·-ì‚­ì œ">ë²„í‚· ì‚­ì œ</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">boto3</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'s3'</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                        <span class="n">aws_acess_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">delete_bucket</span><span class="p">(</span><span class="s">'gid-requests'</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="buckets-and-objects">Buckets and objects</h4>

<p>ë²„ì»·ì— ë‹´ëŠ” ê²ƒì„ objectsë¼ê³  í‘œí˜„í•˜ëŠ”ë° ì´ëŠ”, ì´ë¯¸ì§€ê°€ ë  ìˆ˜ ë„ ìˆê³ ,ë¹„ë””ì˜¤, íŒŒì¼, CSV ë˜ëŠ” ë¡œê·¸ íŒŒì¼ê³¼ ê°™ì€ ê°œì²´ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê°ì²´ ê´€ë¦¬ëŠ” ë°ì´í„° íŒŒì´í”„ ë¼ì¸ì˜ í•µì‹¬  êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤.</p>

<p>S3ì˜ ê°ì²´ ì™€ ë²„í‚·ì€ ë°ìŠ¤í¬íƒ‘ì˜ íŒŒì¼ ë° í´ë”ì™€ ë‹¤ì†Œ ìœ ì‚¬í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.</p>

<p>ë²„í‚·ì€ í´ë”ì™€ ê°™ê³ , ê°ì²´ëŠ” ê·¸ ì•ˆì˜ íŒŒì¼ê³¼ ê°™ë‹¤ê³  ìƒê°í•˜ë©´ í¸í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<p>Bucket</p>

<ul>
  <li>ë²„í‚·ì€ nameì„ ê°€ì§„ë‹¤.</li>
  <li>nameì€ stringì´ë‹¤.</li>
  <li>nameëŠ” ëª¨ë“  S3ì—ì„œ uniqueí•˜ë‹¤</li>
  <li>ë²„í‚·ì—ëŠ” ë§ì€ ê°ì²´ê°€ í¬í•¨ë˜ì–´ ìˆë‹¤.</li>
</ul>

<p>Objects</p>

<ul>
  <li>objectsëŠ” keyë¥¼ ê°€ì§„ë‹¤.</li>
  <li>nameì€ ë²„í‚·ë£¨íŠ¸ì˜ í’€ ê²½ë¡œì´ë‹¤.</li>
  <li>ë²„í‚·ì•ˆì—ì„œ Uniqueí•œ í‚¤ë¥¼ ê°€ì§„ë‹¤.</li>
  <li>objectëŠ” í•˜ë‚˜ì˜ ë²„í‚·ì—ë§Œ ì†í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><br /></p>

<h4 id="creating-the-client">Creating the client</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'s3'</span><span class="p">,</span> <span class="n">region_name</span> <span class="o">=</span> <span class="s">'us-east-1'</span><span class="p">,</span>
                 <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                 <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span>
                 <span class="p">)</span>
<span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'gid_requests_2019_01_01.csv'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'gid_requets_2019_01_01.csv'</span><span class="p">)</span>
</code></pre></div></div>

<p>ë¨¼ì € í´ë¼ì´ì–¸íŠ¸ë¥¼ ë§Œë“¤ì–´ S3 ë³€ìˆ˜ì— í• ë‹¹í•˜ë©´, ê°ì²´ì™€ ë²„í‚·ì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ê°ì²´ ì—…ë¡œë“œ ë°©ë²•ì€, í´ë¼ì´ì–¸íŠ¸ì˜ upload_fileë©”ì†Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<p>Filenameì€ ë¡œì»¬ íŒŒì¼ ê²½ë¡œì´ë©°, Bucket ë§¤ê°œ ë³€ìˆ˜ëŠ” ì—…ë¡œë“œ í•  ë²„í‚·ì˜ ì´ë¦„ì„ ì‚¬ìš©í•˜ë©°, KeyëŠ” ê°ì²´ì˜ ì´ë¦„(AWSì— ì˜¬ë¼ê°ˆ ê²½ë¡œ)ì„ ì§€ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ( í•´ë‹¹ ë©”ì†Œë“œëŠ”, ë°˜í™˜ê°’ì´ ì—†ìŠµë‹ˆë‹¤. )</p>

<p><br /></p>

<h4 id="listing-objects-in-a-bucket">Listing objects in a bucket</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">Bucket</span> <span class="o">=</span> <span class="s">'gid-requests'</span><span class="p">,</span>
                          <span class="n">MaxKeys</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                          <span class="n">Prefix</span><span class="o">=</span><span class="s">'gid_requests_2019_'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></div>

<p>ë²„í‚· ì´ë¦„ì— ëŒ€í•´ gid-requestsë¥¼ ì „ë‹¬í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì˜ list_objects ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ì€ ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<p>MaxKeysì™€, Prefixì˜ ê²½ìš° ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ”ë°, ì´ë¥¼ ì´ìš©í•˜ì—¬, ê°ì²´ë¥¼ ì œí•œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (Prefixì˜ ê²½ìš° Contentsì— Keyê°’ì„ ì´ìš©í•˜ì—¬ í•´ë‹¹í•˜ëŠ” ë‚´ìš©ì„ ë¦¬ìŠ¤íŒ…í•¨.)</p>

<p><br /></p>

<h4 id="getting-objects-metadata">Getting objects metadata</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">head_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requets'</span><span class="p">,</span>
                         <span class="n">Key</span><span class="o">=</span><span class="s">'gid_requets_2018_12_30.csv'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></div>

<p>ë‹¨ì¼ ê°ì²´ì— ëŒ€í•œ ë” ë§ì€ ë‚´ìš©ì„ ì•Œê³  ì‹¶ì„ ë–ˆ, head_objectë©”ì†Œë“œë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="downloading-files">Downloading files</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'gid_requests_downed.csv'</span><span class="p">,</span>
                <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
                <span class="n">Key</span><span class="o">=</span><span class="s">'gid_requests_2018_12_30.csv'</span><span class="p">)</span>
</code></pre></div></div>

<p>íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ í•˜ê¸° ìœ„í•´ì„œëŠ” download_fileë©”ì†Œë¥´ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</p>

<p>Filenameì„ í†µí•´ ë‹¤ìš´ë°›ê³ ìí•˜ëŠ” íŒŒì¼ì˜ ì €ì¥ì¥ì†Œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="deleting-objects">Deleting objects</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">delete_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
                <span class="n">Key</span><span class="o">=</span><span class="s">'gid_requests_2018_12_30.csv'</span><span class="p">)</span>
</code></pre></div></div>

<p>ê°ì²´ë¥¼ ì‚­ì œí•˜ê³  ì‹¶ì„ ë•ŒëŠ”, delete_objectë¥¼ ì´ìš©í•˜ì—¬ ê°ì²´ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h2 id="sharing-files-securely">Sharing Files Securely.</h2>

<p><br /></p>

<p>AWSëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê¶Œí•œì„ ê±°ë¶€í•©ë‹ˆë‹¤. ì¦‰, íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ í‚¤ì™€ ë¹„ë°€ë²ˆí˜¸ë§Œ ì•¡ì„¸ìŠ¤ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì´ëŸ¬í•œ ë™ì‘ì€ ê·€ì°®ì„ì§€ ëª°ë¼ë„, ì„ íƒí•˜ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"https://gid-stagging.s3.amazonaws.com/potholes.csv"</span><span class="p">)</span>
</code></pre></div></div>

<p>ê¸°ë³¸ì ìœ¼ë¡œ, íŒë‹¤ìŠ¤ë¥¼ ì´ìš©í•´ì„œ ë‹¤ìŒ s3ì— ì ‘ê·¼í•˜ë ¤ê³ í•˜ë©´ í—ˆìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>

<p>ì´ëŸ¬í•œ ì ‘ê·¼ì„ ìœ„í•´ì„œëŠ”, ìê²©ì¦ëª…ì„ í†µí•´ s3 í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ë©´ ì‘ë™í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'s3'</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                 <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                 <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">s3</span><span class="p">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">Filenae</span><span class="o">=</span><span class="s">'potholes.csv'</span><span class="p">,</span>
                <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
                <span class="n">Key</span><span class="o">=</span><span class="s">'potholes.csv'</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="aws-permissions-systems">AWS Permissions Systems</h4>

<p>S3ì˜ ê¶Œí•œì„ ì œì–´í•  ìˆ˜ ìˆëŠ” 4ê°€ì§€ì˜ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>IAMì„ ì‚¬ìš©í•˜ì—¬ AWSì„œë¹„ìŠ¤, ë²„í‚· ë° ê°ì²´ì— ëŒ€í•œ ì‚¬ìš©ìì˜ ì•¡ì„¸ìŠ¤ë¥¼ ì œì–´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ë²„í‚· ì •ì±…ì„ í†µí•´ ë²„í‚·ê³¼ ê·¸ ì•ˆì˜ ê°ì²´ë¥¼ ì œì–´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ACL ë˜ëŠ” ì•¡ì„¸ìŠ¤ ì œì–´ ëª©ë¡ì„ í†µí•´ ë²„í‚· ë‚´ì˜ íŠ¹ì • ê°ì²´ì— ëŒ€í•œ ê¶Œí•œì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ë¯¸ë¦¬ ì„œëª… ëœ URLì„ ì‚¬ìš©í•˜ë©´, ê°ì²´ì— ì„ì‹œë¡œ ì•¡ì„¸ìŠ¤ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>

<p><br /></p>

<h4 id="acls">ACLs</h4>

<p>ACLì€ S3ì˜ ì˜¤ë¸Œì íŠ¸ì— ì²¨ë¶€ ëœ ì—”í‹°í‹°ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'potholes.csv'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'potholes.csv'</span><span class="p">)</span>

<span class="n">s3</span><span class="p">.</span><span class="n">put_objects_acl</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
                  <span class="n">Key</span><span class="o">=</span><span class="s">'potholes.csv'</span><span class="p">,</span>
                  <span class="n">ACL</span><span class="o">=</span><span class="s">'public-read'</span><span class="p">)</span>
</code></pre></div></div>

<p>íŒŒì¼ì„ ì—…ë¡œë“œí•œë‹¤ê³  ê°€ì •í•  ë•Œ, ê¸°ë³¸ì ìœ¼ë¡œ, ACLì€ privateì…ë‹ˆë‹¤.</p>

<p>S3_put_object_acl ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬, ACLì„ public-read ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ìœ„ì™€ ê°™ì´ ì„¤ì •í•˜ë©´, ì „ ì„¸ê³„ ëˆ„êµ¬ë‚˜ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="setting-acls-on-upload">Setting ACLs on upload</h4>

<p>ì—…ë¡œë“œì‹œ ACLì„ ê³µê°œ ì½ê¸°ë¡œ ì„¤ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>

<p>í‚¤ ACLê³¼ ê°’ public-readê°€ ìˆëŠ” ì‚¬ì „ì„ ExtraArgs ë§¤ê°œ ë³€ìˆ˜ì— ì „ë‹¬í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
              <span class="n">Filename</span><span class="o">=</span><span class="s">'potholes.csv'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'potholes.csv'</span><span class="p">,</span>
              <span class="n">ExtraArgs</span><span class="o">=</span><span class="p">{</span><span class="s">'ACL'</span><span class="p">:</span><span class="s">'public-read'</span><span class="p">})</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="accessing-public-objects">Accessing public objects</h4>

<p>í¼ë¸”ë¦­ ê°ì²´ê°€ ìˆìœ¼ë©´ ì „ì„¸ê²Œ ëª¨ë“  ì‚¬ëŒì´ ë²„í‚· í˜•ì‹ì˜ URLì—ì„œ ì•¡ì„¸ìŠ¤ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="p">{</span><span class="n">bucket</span><span class="p">}.</span><span class="n">s3</span><span class="p">.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="p">{</span><span class="n">key</span><span class="p">}</span>
  
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">gid</span><span class="o">-</span><span class="n">requests</span><span class="p">.</span><span class="n">s3</span><span class="p">.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="mi">2019</span><span class="o">/</span><span class="n">potholes</span><span class="p">.</span><span class="n">csv</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="generating-public-object-url">Generating public object URL</h4>

<p>Pythonì˜ ë©‹ì§„ ë¬¸ìì—´ í˜•ì‹ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ S3ì—ì„œ ê°ì²´ì˜ ê³µê°œ URLì„ ìƒì„± í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span> <span class="o">=</span> <span class="s">"https://{}.s3.amazonaws.com/{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="s">"gid-requests"</span><span class="p">,</span>
                                             <span class="s">"2019/potholes.csv"</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</code></pre></div></div>

<p>ë²„í‚· ì´ë¦„ê³¼ ê°ì²´ í‚¤ê°€ ë¹ˆ ê´„í˜¸ ì¸ ë¬¸ìì—´ì„ ë§Œë“¤ê³ , formatë©”ì†Œë“œë¥¼ í†µí•´ì„œ ìœ„ì¹˜ ì¸ìˆ˜ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="how-access-is-decided">How access is decided</h4>

<p>ë¯¸ë¦¬ ì„œëª… ëœ URL ì¸ ê²½ìš° ìš”ì²­ì´ ë“¤ì–´ ì˜¤ë©´ ë‹¤ìš´ë¡œë“œê°€ í—ˆìš©ë˜ê³ , ë¯¸ë¦¬ ì„œëª…ë˜ì§€ ì•Šì€ ê²½ìš°, ì •ì±…ì—ì„œ ë‹¤ìš´ë¡œë“œë¥¼ í—ˆìš©í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. AWSì˜ ê¸°ë³¸ ë™ì‘ì€ ì•¡ì„¸ì„œë¥¼ ê±°ë¶€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>

<p align="center"><img src="/images/post_img/boto3.png" /></p>

<p><br /></p>

<h4 id="downloading-a-private-file">Downloading a private file</h4>

<p>íŒŒì¼ì— ëŒ€í•œ ê³µê°œ ì½ê¸° ACLì„ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •í•˜ì§€ ì•Šì€ ê²½ìš°, AWSí•˜ëŠ” ë¹„ê³µê°œë¡œ ì„¤ì •í•©ë‹ˆë‹¤. ì´ë¥¼ ê³µìœ í•˜ê¸° ìœ„í•´ì„œëŠ” boto3ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤,.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'potholes_local.csv'</span><span class="p">,</span>
                <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-staging'</span><span class="p">,</span>
                <span class="n">Key</span><span class="o">=</span><span class="s">'2019/potholes_private.csv'</span><span class="p">)</span>

<span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./potholes_local.csv'</span><span class="p">)</span>
</code></pre></div></div>

<p>boto3ì˜ download_file ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ê³  íŒë‹¤ìŠ¤ê°€ csvë¥¼ ì½ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="accessing-private-files">Accessing private files</h4>

<p>ê·¸ëŸ¬ë‚˜, ìœ„ì˜ ë°©ë²•ë³´ë‹¤ get_objectë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ í›¨ì”¬ ê°„ë‹¨í•œ ë°©ë²•ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="s">'2019/potholes.csv'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s">'Body'</span><span class="p">])</span>
</code></pre></div></div>

<p>ë²„í‚· ì´ë¦„ê³¼ ê°ì²´ í‚¤ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ì—¬ get_object ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="pre-signed-urls">Pre-signed URLs</h4>

<p>pre-signed_urlì„ ì‚¬ìš©í•˜ì—¬ s3 ê°œì¸ ê°ì²´ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ì¼ì‹œì ìœ¼ë¡œ ë¶€ì—¬ í•  ìˆ˜ë„ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>Upload a file</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'./potholes.csv'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'potholes.key'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>Generate Presigned URL</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">share_url</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">generate_presigned_url</span><span class="p">(</span><span class="n">ClientMethod</span><span class="o">=</span><span class="s">'get_object'</span><span class="p">,</span>
                                     <span class="n">ExpiresIn</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
                                     <span class="n">Params</span><span class="o">=</span><span class="p">{</span><span class="s">'Bucket'</span><span class="p">:</span> <span class="s">'gid-requests'</span><span class="p">,</span>
                                            <span class="s">'Key'</span><span class="p">:</span> <span class="s">'potholes.csv'</span><span class="p">})</span>
<span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">share_url</span><span class="p">)</span>
</code></pre></div></div>

<p>3600ì´ˆ ë™ì•ˆ, íŒŒì¼ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” urlì„ ìƒì„±í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="load-mulitple-files-into-one-dataframe">Load mulitple files into one DataFrame</h4>

<p>ì¢…ì¢… ë°ì´í„° ì—”ì§€ë‹ˆì–´ëŠ” s3ì—ì„œ ì—¬ëŸ¬ íŒŒì¼ì„ êµ¬ë¬¸ ë¶„ì„í•´ì•¼í•©ë‹ˆë‹¤.</p>

<p>íŒ¨í„´ì— ë”°ë¼ í•˜ë‚˜ì˜ DataFrameì— ë¡œë“œí•œ ë‹¤ìŒ, ë¬´ì–¸ê°€ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
                          <span class="n">Prefix</span><span class="o">=</span><span class="s">'2019/'</span><span class="p">)</span>

<span class="n">request_files</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">'Contents'</span><span class="p">]</span>

<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">request_files</span><span class="p">:</span>
  <span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
                     <span class="n">Key</span><span class="o">=</span><span class="nb">file</span><span class="p">[</span><span class="s">'Key'</span><span class="p">])</span>
  
  <span class="n">obj_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s">'Body'</span><span class="p">])</span>
  <span class="n">df_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_df</span><span class="p">)</span>
  
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
</code></pre></div></div>

<p>ìœ„ì™€ê°™ì´ ì—¬ëŸ¬íŒŒì¼ì„ arrayì— ë‹´ì•„ì„œ, ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì´í›„ concatë¥¼ ì´ìš©í•´ì„œ, í•˜ë‚˜ì˜ DataFrameìœ¼ë¡œ ê²°í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="serving-html-pages">Serving HTML pages</h4>

<p>S3ëŠ” HTMLí˜ì´ì§€ë¥¼ ì œê³µ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì´ëŠ” ë¶„ì„ ê²°ê³¼ë¥¼ ê²½ì˜ì§„ê³¼ ê³µìœ í•˜ê³  íŒŒì´í”„ ë¼ì¸ì„ í†µí•´ ê²°ê³¼ë¥¼ ì—…ë°ì´íŠ¸ í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.</p>

<p>ë§ì€ íŒŒì´ì¬ ë°ì´í„° ê³¼í•™ ë„êµ¬ì—ì„œëŠ” ë°ì´í„°ì—ì„œ ê°„ë‹¨í•œ HTMLì„ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="html-table-in-pandas">HTML table in Pandas</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">to_html</span><span class="p">(</span><span class="s">'table_agg.html'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì´ë¥¼ ì‚¬ìš©í•˜ì—¬, DataFrameì„ HTML íŒŒì¼ì— ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì„ íƒì ìœ¼ë¡œ render_links ì¸ìˆ˜ëŠ” ëª¨ë“  URLì„ í´ë¦­ í•  ìˆ˜ ìˆë„ë¡ ë³€í™˜í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">to_html</span><span class="p">(</span><span class="s">'table_agg.html'</span><span class="p">,</span> <span class="n">render</span><span class="o">=</span><span class="n">links</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Columns ë§¤ê°œ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë Œë”ë§í•˜ë ¤ëŠ” ì—´ë§Œ ëª©ë¡ìœ¼ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">to_html</span><span class="p">(</span><span class="s">'table_agg.html'</span><span class="p">,</span> <span class="n">render_links</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
           <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'service_name'</span><span class="p">,</span> <span class="s">'request_count'</span><span class="p">,</span> <span class="s">'info_link'</span><span class="p">])</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="borders">Borders</h4>

<p>Borderì¸ìˆ˜ë¥¼ í†µí•´ ëª‡ ê°€ì§€ ê¸°ë³¸ í…Œë‘ë¦¬ ì»¨íŠ¸ë¡¤ì´ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">to_html</span><span class="p">(</span><span class="s">'table_agg.html'</span><span class="p">,</span>
          <span class="n">render_links</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'service_name'</span><span class="p">,</span> <span class="s">'requests_count'</span><span class="p">,</span> <span class="s">'info_link'</span><span class="p">],</span>
          <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>ê°’ì´ 0ì´ë©´, í…Œë‘ë¦¬ê°€ ì œê±°ë˜ê³ , ê°’ì´ 1ì´ë©´ í…Œë‘ë¦¬ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="uploading-an-html-file-to-s3">Uploading an HTML file to S3</h4>

<p>html íŒŒì¼ì„ ì—…ë¡œë“œí•˜ëŠ” ê²ƒì€ ë‹¤ë¥¸ íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<p>ë¸Œë¼ìš°ì €ê°€ HTMLë¡œ ì·¨ê¸‰ í•  ìˆ˜ ìˆë„ë¡ ContentTypeì„ ì„¤ì •í•´ì•¼í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'./table_agg.html'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'datacamp-website'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'table.html'</span><span class="p">,</span>
              <span class="n">ExtraArgs</span> <span class="o">=</span> <span class="p">{</span><span class="s">'ContentType'</span><span class="p">:</span> <span class="s">'text/html'</span><span class="p">.</span>
                          <span class="s">'ACL'</span><span class="p">:</span> <span class="s">'public-read'</span><span class="p">})</span>
</code></pre></div></div>

<p>upload_file ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ S3ì— ì—…ë¡œë“œí•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="uploading-other-types-of-content">Uploading other types of content</h4>

<p>Pythonì˜ ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ìƒì„± ëœ ê²ƒê³¼ ê°™ì€ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ëŠ” ê²ƒì€ ìœ„ì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'./plot_image.png'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'datacamp-website'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'plot_image.png'</span><span class="p">,</span>
              <span class="n">ExtraArgs</span> <span class="o">=</span> <span class="p">{</span><span class="s">'ContentType'</span><span class="p">:</span> <span class="s">'image/png'</span><span class="p">,</span>
                          <span class="s">'ACL'</span><span class="p">:</span> <span class="s">'public-read'</span><span class="p">})</span>
</code></pre></div></div>

<p>HTML íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì§€ë§Œ, ë¸Œë¼ìš°ì €ì—ì„œ ë Œë”ë§í•˜ë ¤ë©´ ì—…ë¡œë“œí•˜ëŠ” ë™ì•ˆ ì ì ˆí•œ contentTypeì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<p>PNGì˜ ê²½ìš° contentTypeìœ¼ë¡œ image/pngë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="iana-media-types">IANA Media Types</h4>

<p>IANAì—ëŠ” íŒŒì¼ í™•ì¥ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ëª¨ë“  íŒŒì¼ ìœ í˜• ëª©ë¡ì´ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>JSON : application/json</li>
  <li>PNG : image/png</li>
  <li>PDF : application/pdf</li>
  <li>CSV : text/csv</li>
</ul>

<p><br /></p>

<h4 id="generating-an-index-page">Generating an index page</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">r</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-reports'</span><span class="p">,</span> <span class="n">Prefix</span><span class="o">=</span><span class="s">'2019/'</span><span class="p">)</span>
<span class="n">objects_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s">'Contents'</span><span class="p">])</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="s">'http://datacamp-website.s3.amazonaws.com/'</span>
<span class="n">objects_df</span><span class="p">[</span><span class="s">'Link'</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">objects_df</span><span class="p">[</span><span class="s">'Key'</span><span class="p">]</span>

<span class="n">objects_df</span><span class="p">.</span><span class="n">to_html</span><span class="p">(</span><span class="s">'report_listing.html'</span><span class="p">,</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Link'</span><span class="p">,</span> <span class="s">'LastModified'</span><span class="p">,</span> <span class="s">'Size'</span><span class="p">],</span>
                  <span class="n">render_links</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>ëª©ë¡ì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì€ ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<p>ë¨¼ì € ë²„í‚·ì˜ ê°ì²´ë¥¼ ë‚˜ì—´í•˜ê³ , DataFrameìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ê°ì²´ì˜ ëª¨ë“  í‚¤ì— ëŒ€í•œ URLì„ ìƒì„±í•˜ëŠ” ë§í¬ì—´ì„ ìƒì„±í•˜ê³ , DataFrameì„ HTMLì— ì‘ì„±í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="uploading-index-page">Uploading index page</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'./report_listing.html'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'datacamp-website'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'index.html'</span><span class="p">,</span>
              <span class="n">ExtraArgs</span> <span class="o">=</span> <span class="p">{</span><span class="s">'ContentType'</span><span class="p">:</span> <span class="s">'text/html'</span><span class="p">,</span>
                          <span class="s">'ACL'</span><span class="p">:</span> <span class="s">'public-read'</span><span class="p">})</span>
</code></pre></div></div>

<p>ë‹¤ë¥¸ HTML íŒŒì¼ì²˜ëŸ¼ ìƒì„±í•œ ìƒ‰ì¸ í˜ì´ì§€ë¥¼ ì—…ë¡œë“œí•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="generating-a-report-repository">Generating a Report Repository</h4>

<ul>
  <li>Read raw data files</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span>
                          <span class="n">Prefix</span><span class="o">=</span><span class="s">'2019_jan'</span><span class="p">)</span>

<span class="n">request_files</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">'Contents'</span><span class="p">]</span>

<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">request_files</span><span class="p">:</span>
  <span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-requests'</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="nb">file</span><span class="p">[</span><span class="s">'Key'</span><span class="p">])</span>
  
  <span class="n">obj_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s">'Body'</span><span class="p">])</span>
  
  <span class="n">df_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_df</span><span class="p">)</span>
  
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<ul>
  <li>Create aggregated reports</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'jan_final_report.csv'</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">to_html</span><span class="p">(</span><span class="s">'jan_final_report.html'</span><span class="p">)</span>
<span class="n">jan_final_chart</span><span class="p">.</span><span class="n">html</span> <span class="c1"># bokeh í”Œë¡¯
</span></code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±í›„, gid-reports ë²„í‚·ì— ì§‘ê³„ ëœ ë³´ê³ ì„œë¥¼ ë°°ì¹˜í•©ë‹ˆë‹¤.</p>

<ul>
  <li>Upload Aggregated CSV</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'./jan_final_report.csv'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'2019/jan/final_report.csv'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-reports'</span><span class="p">,</span>
              <span class="n">ExtraArgs</span><span class="o">=</span><span class="p">{</span><span class="s">'ACL'</span><span class="p">:</span> <span class="s">'public-read'</span><span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>Upload HTML Table</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'./jan_final_report.html'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'2019/jan/final_report.html'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-reports'</span><span class="p">,</span>
              <span class="n">ExtraArgs</span><span class="o">=</span><span class="p">{</span><span class="s">'ContentType'</span><span class="p">:</span> <span class="s">'text/html'</span><span class="p">,</span>
                        <span class="s">'ACL'</span> <span class="p">:</span> <span class="s">'public-read'</span><span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>Upload HTML Chart</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'./jan_final_chart.html'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'2019/jan/final_chart.html'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-reports'</span><span class="p">,</span>
              <span class="n">ExtraArgs</span><span class="o">=</span><span class="p">{</span><span class="s">'ContentType'</span><span class="p">:</span> <span class="s">'text/html'</span><span class="p">,</span>
                        <span class="s">'ACL'</span> <span class="p">:</span> <span class="s">'pulic-read'</span><span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>Create index.html</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">r</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-reports'</span><span class="p">,</span> <span class="n">Prefix</span><span class="o">=</span><span class="s">'2019/'</span><span class="p">)</span>

<span class="n">objects_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s">'Contents'</span><span class="p">])</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="s">"https://gid-reports.s3.amazonaws.com/"</span>
<span class="n">objects_df</span><span class="p">[</span><span class="s">'Link'</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">objects_df</span><span class="p">[</span><span class="s">'Key'</span><span class="p">]</span>

<span class="n">objects_df</span><span class="p">.</span><span class="n">to_html</span><span class="p">(</span><span class="s">'report_listing.html'</span><span class="p">,</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Link'</span><span class="p">,</span> <span class="s">'LastModified'</span><span class="p">,</span> <span class="s">'Size'</span><span class="p">],</span>
                  <span class="n">render_links</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>Upload index.html</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'./report_listing.html'</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s">'index.html'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'gid-reports'</span><span class="p">.</span>
              <span class="n">ExtraArgs</span> <span class="o">=</span> <span class="p">{</span><span class="s">'ContentType'</span><span class="p">:</span> <span class="s">'text/html'</span><span class="p">,</span>
                          <span class="s">'ACL'</span><span class="p">:</span> <span class="s">'public-read'</span><span class="p">})</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="reporting-and-notifying">Reporting and Notifying!</h2>

<p><br /></p>

<p>Amazon SNSëŠ” ê°„ë‹¨í•œ ì•Œë¦¼ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì´ê²ƒì„ ì´ìš©í•´ì„œ, ì´ë©”ì¼, ë¬¸ì ë©”ì‹œì§€ ë° í‘¸ì‹œ ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ê²Œì‹œìëŠ” ì£¼ì œì— ë©”ì‹œì§€ë¥¼ ê²Œì‹œí•˜ê³  ê°€ì…ìëŠ” ë©”ì‹œì§€ë¥¼ ë°›ìŠµë‹ˆë‹¤.</p>

<p>AWS SNSì„ ê²€ìƒ‰í•´ì„œ ë“¤ì–´ê°€ë©´, ëŒ€ì‹œë³´ë“œê°€ ìˆëŠ”ë°, Topics ì™€ Subscriptionsì— ê´€í•œ ë‚´ìš©ì´ í‘œì‹œë©ë‹ˆë‹¤.</p>

<p>ëª¨ë“  TopicsëŠ”, ARN ë˜ëŠ” Amazon ë¦¬ì†ŒìŠ¤ ì´ë¦„ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ê³ ìœ  IDì…ë‹ˆë‹¤.</p>

<p align="center"><img src="/images/post_img/boto4.png" /></p>

<p>í•˜ë‹¨ì—ëŠ” êµ¬ë… ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤. ì´ë˜í•œ ê³ ìœ  IDë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="creating-an-sns-topic">Creating an SNS Topic</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'sns'</span><span class="p">,</span> <span class="n">region_name</span> <span class="o">=</span> <span class="s">'us-east-1'</span><span class="p">,</span>
                  <span class="n">aws_access_key_id</span> <span class="o">=</span> <span class="n">AWS_KEY_ID</span><span class="p">,</span>
                  <span class="n">aws_secret_access_key</span> <span class="o">=</span> <span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">create_topic</span><span class="p">(</span><span class="n">Name</span><span class="o">=</span><span class="s">'city_alerts'</span><span class="p">)</span>

<span class="n">topic_arn</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">'TopicArn'</span><span class="p">]</span>
<span class="c1"># or
# sns.create_topic(Name='city_alerts')['TopicArn']
</span></code></pre></div></div>

<p>SNS ì£¼ì œë¥¼ ë§Œë“¤ê¸° ìœ„í•´ SNS í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤. ì´ì „ê³¼ ë‹¤ë¥´ê²Œ â€˜s3â€™ê°€ ì•„ë‹Œ â€˜snsâ€™ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<p>ì´ì œ í´ë¼ì´ì–¸íŠ¸ê°€ ìƒê²¼ìœ¼ë¯€ë¡œ create_topic ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì£¼ì œë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>

<p>ë³€ìˆ˜ì— ì €ì¥í•˜ê¸° ìœ„í•´ì„œ ì‘ë‹µ TopicArní‚¤ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="listing-topics">Listing topics</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">list_topics</span><span class="p">()</span>
</code></pre></div></div>

<p>list_topic ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ë©´ ì£¼ì œë¥¼ Topics ë¥¼ ë‚˜ì—´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="deleting-topics">Deleting topics</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">delete_topic</span><span class="p">(</span><span class="n">TopicArn</span><span class="o">=</span><span class="s">'arn:aws:sns:us-east-1:320333783981:city_alerts'</span><span class="p">)</span>
</code></pre></div></div>

<p>Topicsë¥¼ ì‚­ì œí•˜ë ¤ë©´, TopicArnì„ delete_topicë©”ì†Œë“œì— ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="creating-an-sms-subscription">Creating an SMS subscription</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'sns'</span><span class="p">,</span> <span class="n">region_name</span> <span class="o">=</span> <span class="s">'us-east-1'</span><span class="p">,</span>
                  <span class="n">aws_access_key_id</span> <span class="o">=</span> <span class="n">AWS_KEY_ID</span><span class="p">,</span>
                  <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span><span class="p">.</span> <span class="n">ns</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">TopicArn</span> <span class="o">=</span><span class="s">"arn:was:sns:us-east-1:320333787981:city_alerts"</span><span class="p">,</span>
                        <span class="n">Protocol</span><span class="o">=</span><span class="s">'SMS'</span><span class="p">,</span> <span class="n">Endpoint</span><span class="o">=</span><span class="s">'+13125551123'</span><span class="p">)</span>
</code></pre></div></div>

<p>SMS êµ¬ë…ì„ ë§Œë“¤ê¸° ìœ„í•´ boto3 SNS í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.</p>

<p>ì´í›„, TopicArnì„ ì „ë‹¬í•˜ì—¬, SNS subscribeë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. í”„ë¡œí† ì½œì€ SMSì´ì—¬, end-pointëŠ” ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="creating-an-email-subscription">Creating an email subscription</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span><span class="n">sns</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">TopicArn</span> <span class="o">=</span><span class="s">"arn:was:sns:us-east-1:320333787981:city_alerts"</span><span class="p">,</span>
                        <span class="n">Protocol</span><span class="o">=</span><span class="s">'email'</span><span class="p">,</span> <span class="n">Endpoint</span><span class="o">=</span><span class="s">'max@maksimize.com'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì´ë©”ì¼ êµ¬ë… ì‘ì„±ë„ SMSì™€ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤. í”„ë¡œí† ì½œì„ emailë¡œ ì„¤ì •í•˜ê³  , EndpointëŠ” ì´ë©”ì¼ë¡œ ì„¤ì •í•˜ë©´ë©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="listing-subscriptions-by-topic">Listing subscriptions by Topic</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">list_subscriptions_by_topic</span><span class="p">(</span><span class="n">TopicArn</span><span class="o">=</span><span class="s">"arn:was:sns:us-east-1:320333787981:city_alerts"</span><span class="p">)</span>

<span class="n">sns</span><span class="p">.</span><span class="n">list_subscriptions</span><span class="p">()[</span><span class="s">'Subscriptions'</span><span class="p">]</span>
</code></pre></div></div>

<p>ê³ ê°ì˜ list_subscriptions_by_topic ë©”ì†Œë“œë¥¼ ì´ìš©í•´ì„œ TopicArnì„ ì „ë‹¬í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="deleting-subscriptions">Deleting subscriptions</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">SubscriptionArn</span><span class="o">=</span><span class="s">"arn:was:sns:us-east-1:320333787981:city_alerts:9f2dad1d-8844-4fe8"</span><span class="p">)</span>
</code></pre></div></div>

<p>êµ¬ë…ì„ ì‚­ì œí•˜ê³  ì‹¶ìœ¼ë©´, SNS êµ¬ë… ì·¨ì†Œ ë©”ì†Œë“œë¥¼ ì´ìš©í•´ì„œ ì‚­ì œí•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="deleting-multiple-subscriptions">Deleting multiple subscriptions</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">list_subscriptions_by_topic</span><span class="p">(</span><span class="s">"arn:was:sns:us-east-1:320333787981:city_alerts"</span><span class="p">)</span>
<span class="n">subs</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">'Subscriptions'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">subs</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">sub</span><span class="p">[</span><span class="s">'Protocol'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'sms'</span><span class="p">:</span>
    <span class="n">sns</span><span class="p">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">sub</span><span class="p">[</span><span class="s">'SubscriptionArn'</span><span class="p">])</span>
</code></pre></div></div>

<p>ëª¨ë“  êµ¬ë…ì— ëŒ€í•´ SMSì¸ ê²½ìš° êµ¬ë… ì·¨ì†Œ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ì€ ìœ„ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="publishing-to-a-topic">Publishing to a Topic</h4>

<p>Topicì— ë©”ì‹œì§€ë¥¼ ê²Œì‹œí•˜ë©´, ëª¨ë“  êµ¬ë…ìê°€ ë©”ì‹œì§€ë¥¼ ë°›ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">TopicArn</span><span class="o">=</span><span class="s">"arn:was:sns:us-east-1:320333787981:city_alerts"</span><span class="p">,</span>
                      <span class="n">Message</span> <span class="o">=</span> <span class="s">'Body text of SMS or e-mail'</span><span class="p">,</span>
                      <span class="n">Subject</span> <span class="o">=</span> <span class="s">'Subject Line for Email'</span><span class="p">)</span>
</code></pre></div></div>

<p>Topicì— ê²Œì‹œí•˜ê¸° ìœ„í•´ì„œëŠ”, TopicArn, message ë° subjectë¥¼ ì¸ìë¡œ ì „ë‹¬ë°›ìŠµë‹ˆë‹¤.</p>

<p>ë©”ì‹œì§€ ì¸ìëŠ”, ë©”ì‹œì§€ ë³¸ë¬¸ì˜ ë‚´ìš©ì´ë©°, SubjectëŠ” ì œëª©ì…ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="sending-custom-messages">Sending custom messages</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">num_of_reports</span> <span class="o">=</span> <span class="mi">137</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span>
	<span class="n">TopicArn</span> <span class="o">=</span> <span class="s">"arn:was:sns:us-east-1:320333787981:city_alerts"</span><span class="p">,</span>
	<span class="n">Message</span> <span class="o">=</span> <span class="s">'There are {} reports outstanding'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">num_of_reports</span><span class="p">),</span>
	<span class="n">Subject</span> <span class="o">=</span> <span class="s">'Subject Line for Email'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì‚¬ìš©ì ì •ì˜ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê¸° ìœ„í•´ì„œëŠ”, íŒŒì´ì¬ ë¬¸ìì—´ í˜•ì‹ ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="sending-a-single-sms">Sending a single SMS</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">PhoneNumber</span> <span class="o">=</span> <span class="s">'+13121233211'</span><span class="p">,</span>
                      <span class="n">Message</span> <span class="o">=</span> <span class="s">'Body text of SMS or e-mail'</span><span class="p">)</span>
</code></pre></div></div>

<p>ë‹¨ì¼ SMSë¥¼ ë³´ë‚´ê¸° ìœ„í•´ ë™ì¼í•˜ê²Œ, boto3 SNS í´ë¼ì´ì–¸íŠ¸ì˜ pulishë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<p>Message ì¸ìëŠ”, í…ìŠ¤íŠ¸ì˜ ë³¸ë¬¸ì´ë©°, PhoneNumberì€ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="not-a-good-long-term-practice">Not a good long term practice</h4>

<p>ì´ëŸ¬í•œ ì¼íšŒì„± ë¬¸ì ë©”ì‹œì§€ëŠ”, ìœ ìš©í•˜ì§€ë§Œ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì—ëŠ” ë§¤ìš° ê¹Œë‹¤ë¡œìš´ ë°©ë²•ì…ë‹ˆë‹¤.</p>

<p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ì˜ ì„ë¬´ ì¤‘ í•˜ë‚˜ëŠ” ë°ì´í„°ë¥¼ ìœ ì§€ ê´€ë¦¬ í•  ìˆ˜ ìˆê²Œí•˜ëŠ” ì—…ë¬´ ìˆ˜í–‰ì— ê· í˜•ì„ ë§ì¶”ëŠ” ê²ƒ ì…ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="building-the-notification-system">Building the notification system</h4>

<p>êµ¬ë©ì´ ë° ë¶ˆë²• íˆ¬ê¸° ì”ê³ ê°€ í†µì œ ë¶ˆëŠ¥ ìƒíƒœë¡œ ì¦ê°€í•˜ê³ , ì‹œì˜íšŒê°€ ì´ì‚¬ë“¤ì´ ì–¸ì œ ì—…ë¬´ë¥¼ ìˆ˜í–‰í•˜ê³  ìˆëŠ”ì§€ ì•Œë¦¬ëŠ” êµ¬ì¡°ë¥¼ ìš”ì²­í–ˆë‹¤.</p>

<p>ì´ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´, ì´ë©”ì¼ ì „í™”ë²ˆí˜¸ì™€ í•¨ê»˜ CSVë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. ì´ ëª©ë¡ì„ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•œ trash_nontifications Topicì— ëŒ€í•œ êµ¬ë…ì„ ì‘ì„±í•©ë‹ˆë‹¤. ê·¸ í›„, final_reportë¥¼ í™•ì¸í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë¶ˆë²• íˆ¬ê¸° ì‚¬ë¡€ê°€ 30ì´ ì´ˆê³¼í•˜ë©´, trash_notificaition Topicì— publishë©ë‹ˆë‹¤.</p>

<ul>
  <li>Create the topic</li>
  <li>Download the contact list csv</li>
  <li>Create topics for each service</li>
  <li>Subcribe the contacts to their respective topics</li>
  <li>Download the monthly get it done report</li>
  <li>Get the count of Potholes</li>
  <li>
    <p>Get the count of Illegal dumping notifications</p>
  </li>
  <li>If potholes exceeds 100, send alert</li>
  <li>If illegal dumping exceeds 30, send alert</li>
</ul>

<p><br /></p>

<h4 id="topic-set-up">Topic set up</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'sns'</span><span class="p">,</span> <span class="n">region_name</span> <span class="o">=</span> <span class="s">'us-east-1'</span><span class="p">,</span>
                  <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                  <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">trash_arn</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">create_topic</span><span class="p">(</span><span class="n">Name</span><span class="o">=</span><span class="s">"trash_notifications"</span><span class="p">)[</span><span class="s">'TopicArn'</span><span class="p">]</span>
<span class="n">streets_arn</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">create_topic</span><span class="p">(</span><span class="n">Name</span><span class="o">=</span><span class="s">"streets_notifications"</span><span class="p">)[</span><span class="s">'TopicArn'</span><span class="p">]</span>
</code></pre></div></div>

<p>ë¨¼ì € íœ´ì§€í†µ ê±°ë¦¬ ì•Œë¦¼ì— ëŒ€í•œ ì£¼ì œë¥¼ ë§Œë“­ë‹ˆë‹¤. ë‚˜ì¤‘ì— ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ARNì„ ë³€ìˆ˜ì— ì €ì¥í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="subscribing-users-to-topics">Subscribing users to topics</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">contacts</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"https://gid-staging.s3.amazonaws.com/contacts.csv"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">subscribe_user</span><span class="p">(</span><span class="n">user_row</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">uesr_row</span><span class="p">[</span><span class="s">'Department'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'trash'</span><span class="p">:</span>
  	<span class="n">sns</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">TopicArn</span> <span class="o">=</span> <span class="n">trash_arn</span><span class="p">,</span> <span class="n">Protocol</span><span class="o">=</span><span class="s">'sms'</span><span class="p">,</span> <span class="n">Endpoint</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">user_row</span><span class="p">[</span><span class="s">'Phone'</span><span class="p">]))</span>
  	<span class="n">sns</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">TopicArn</span> <span class="o">=</span> <span class="n">trash_arn</span><span class="p">,</span> <span class="n">Protocol</span><span class="o">=</span><span class="s">'email'</span><span class="p">,</span> <span class="n">Endpoint</span><span class="o">=</span><span class="n">user_row</span><span class="p">[</span><span class="s">'Email'</span><span class="p">])</span>
  <span class="k">else</span><span class="p">:</span>
  	<span class="n">sns</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">TopicArn</span> <span class="o">=</span> <span class="n">streets_arn</span><span class="p">,</span> <span class="n">Protocol</span><span class="o">=</span><span class="s">'sms'</span><span class="p">,</span> <span class="n">Endpoint</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">user_row</span><span class="p">[</span><span class="s">'Phone'</span><span class="p">]))</span>
  	<span class="n">sns</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">TopicArn</span> <span class="o">=</span> <span class="n">streets_arn</span><span class="p">,</span> <span class="n">Protocol</span><span class="o">=</span><span class="s">'email'</span><span class="p">,</span> <span class="n">Endpoint</span><span class="o">=</span><span class="n">user_row</span><span class="p">[</span><span class="s">'Email'</span><span class="p">])</span>    
</code></pre></div></div>

<p>ë°ì´í„°ì— ìˆëŠ” ì •ë³´ë¥¼ ì´ìš©í•´ì„œ, êµ¬ë…ì„ ì§„í–‰í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">contacts</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">subscribe_user</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="get-the-aggregated-numbers">Get the aggregated numbers</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"http://gid-reports.s3.amazonaws.com/2019/feb/final_report.csv"</span><span class="p">)</span>

<span class="n">df</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'service_name'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">trash_violations_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">at</span><span class="p">[</span><span class="s">'Illegal Dumping'</span><span class="p">,</span> <span class="s">'count'</span><span class="p">]</span>
<span class="n">streets_violations_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">at</span><span class="p">[</span><span class="s">'Pothole'</span><span class="p">,</span> <span class="s">'count'</span><span class="p">]</span>
</code></pre></div></div>

<p>ì´í›„, í•´ë‹¹ ë°ì´í„°ë¥¼ ë³€ìˆ˜ì— ì €ì¥í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="send-alerts">Send Alerts</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">trash_violations_count</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
  <span class="n">message</span> <span class="o">=</span> <span class="s">"Trash violations count is now {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">trash_violations_count</span><span class="p">)</span>
  <span class="n">sns</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">TopicArn</span> <span class="o">=</span> <span class="n">trash_arn</span><span class="p">,</span>
             <span class="n">Message</span> <span class="o">=</span> <span class="n">message</span><span class="p">,</span>
             <span class="n">Subject</span> <span class="o">=</span> <span class="s">"Trash Alert"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">streets_violations_count</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
  <span class="n">message</span> <span class="o">=</span> <span class="s">"Streets violations count is now {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">streets_violations_count</span><span class="p">)</span>
  <span class="n">sns</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">TopicArn</span> <span class="o">=</span> <span class="n">streets_arn</span><span class="p">,</span>
             <span class="n">Message</span> <span class="o">=</span> <span class="n">message</span><span class="p">,</span>
             <span class="n">Subject</span> <span class="o">=</span> <span class="s">"Streets Alert"</span><span class="p">)</span>
</code></pre></div></div>

<p>ë§Œì•½ í•´ë‹¹ ë³€ìˆ˜ê°€ ì„¤ì •í•œ ê°’ ì´ìƒì¼ê²½ìš°, ê²½ê³  ë©”ì„¸ì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.</p>

<p><br /></p>

<h2 id="pattern-rekognition">Pattern Rekognition</h2>

<p><br /></p>

<p>Boto3 ë¬¸ì„œì™€ AWS ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬, Rekognitionì´ë¼ëŠ” ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="rekognition">Rekognition</h4>

<p>Rekognitionì€ AWSì˜ ì»´í“¨í„° ë¹„ì „ APIì…ë‹ˆë‹¤.</p>

<ul>
  <li>Detecting Objects in an image</li>
  <li>Extracting Text from Images</li>
</ul>

<p><br /></p>

<h4 id="rekognition-ì‚¬ìš©ì´ìœ ">Rekognition ì‚¬ìš©ì´ìœ </h4>

<p>ìš°ë¦¬ê°€ ì§ì ‘ ëª¨ë¸ì„ ë§Œë“ ë‹¤ë©´, ì¸ì‹ê³¼ ê°™ì€ í•˜ë‚˜ì˜ íŠ¹ì • ì„ë¬´ë¥¼ ìœ„í•´ í›ˆë ¨ì„ í•©ë‹ˆë‹¤. ì´ëŠ” Training ë°ì´í„°ê°€ í•„ìš”í•˜ê³ , ëª¨ë¸ì„ ë°°í¬í•˜ê³  ìœ ì§€ ê´€ë¦¬í•´ì•¼í•©ë‹ˆë‹¤.</p>

<ul>
  <li>Quick but good</li>
  <li>Keep code simple</li>
  <li>Recognize many things</li>
</ul>

<h5><br /></h5>

<h4 id="upload-an-image-to-s3">Upload an image to S3</h4>

<p>ë¬¼ì²´ ê°ì§€ë¥¼ ìœ„í•´ ì¸ì‹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë´…ë‹ˆë‹¤.</p>

<p>ì‹œëŠ”, ì¹´ë©”ë¼ë¥¼ ì§€ë‚˜ê°€ëŠ” ìì „ê±°ë¥¼ ì„¸ë ¤ê³ í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì„ í•˜ê¸° ì „ì—, ì´ë¯¸ì§€ë¥¼ S3ì— ì—…ë¡œë“œí•´ì•¼í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'s3'</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                 <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">s3</span><span class="p">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">'report.jpg'</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="s">'report.jpg'</span><span class="p">,</span>
              <span class="n">Bucket</span><span class="o">=</span><span class="s">'datacamp-img'</span><span class="p">)</span>
</code></pre></div></div>

<p>S3 í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ˆê¸°í™” í•œ ë‹¤ìŒ, upload file ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="object-detection">Object detection</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rekog</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'rekognition'</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                    <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                    <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">rekog</span><span class="p">.</span><span class="n">detect_labels</span><span class="p">(</span><span class="n">Image</span><span class="o">=</span><span class="p">{</span><span class="s">'S3Object'</span><span class="p">:</span>
                                      <span class="p">{</span><span class="s">'Bucekt'</span><span class="p">:</span><span class="s">'datacamp-img'</span><span class="p">,</span>
                                      <span class="s">'Name'</span><span class="p">:</span><span class="s">'report.jpg'</span><span class="p">},</span>
                                     <span class="n">MaxLabels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                     <span class="n">MinConfidence</span><span class="o">=</span><span class="mi">95</span><span class="p">})</span>
</code></pre></div></div>

<p>ì´í›„ boto3 Rekognition í´ë¼ì´ì–¸íŠ¸ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. ë²„ì¼“ ë° ì´ë¯¸ì§€ë¥¼ ì§€ì •í•˜ê³ , ì„ íƒì ìœ¼ë¡œ, ë°˜í™˜ í•  ìµœëŒ€ ë¼ë²¨ ìˆ˜, ë° ìµœì†Œí•œì˜ ì‹ ë¢°ì •ë„ë¥¼ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="text-detection">Text detection</h4>

<p>í…ìŠ¤íŠ¸ ì¶”ì¶œë„ ë¹„ìŠ·í•˜ê²Œ ì‘ë™ë©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">rekog</span><span class="p">.</span><span class="n">detect_text</span><span class="p">(</span><span class="n">Image</span><span class="o">=</span><span class="p">{</span><span class="s">'S3Object'</span><span class="p">:</span>
                                   <span class="p">{</span>
                                     <span class="s">'Bucket'</span><span class="p">:</span> <span class="s">'datacamp-img'</span><span class="p">,</span>
                                     <span class="s">'Name'</span><span class="p">:</span> <span class="s">'report.jpg'</span>
                                   <span class="p">}})</span>
</code></pre></div></div>

<p>í´ë¼ì´ì–¸íŠ¸ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™” í•œ ë‹¤ìŒ, detect_textë¥¼ í˜¸ì¶œí•˜ì—¬ ì´ë¯¸ì§€ ë° ë²„í‚·ì„ ì…ë ¥í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="translating-text">Translating text</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">translate</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'translate'</span><span class="p">,</span>
                        <span class="n">region_name</span> <span class="o">=</span> <span class="s">'us-east-1'</span><span class="p">,</span>
                        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">translate</span><span class="p">.</span><span class="n">translate_text</span><span class="p">(</span><span class="n">Text</span><span class="o">=</span><span class="s">'Hello, how are you?'</span><span class="p">,</span>
                                   <span class="n">SourceLanguageCode</span><span class="o">=</span><span class="s">'auto'</span><span class="p">,</span>
                                   <span class="n">TargetLanguageCode</span><span class="o">=</span><span class="s">'es'</span><span class="p">)</span>
</code></pre></div></div>

<p>AWSë¥¼ ì´ìš©í•´ì„œ, translating í•˜ëŠ” ë°©ë²•ë„ ìœ„ì™€ ìœ ì‚¬í•©ë‹ˆë‹¤. ë¨¼ì € AWS translate ìš© boto3í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.</p>

<p>ì´í›„, translate_text ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. í…ìŠ¤íŠ¸ ì¸ìˆ˜ë¡œ, ë²ˆì—­í•˜ë ¤ëŠ” í…ìŠ¤íŠ¸ë¥¼ ì „ë‹¬í•˜ê³ , ì–¸ì–´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">translate</span><span class="p">.</span><span class="n">translate_text</span><span class="p">(</span><span class="n">Text</span><span class="o">=</span><span class="s">'Hello, how are you?'</span><span class="p">,</span>
                                   <span class="n">SourceLanguageCode</span><span class="o">=</span><span class="s">'auto'</span><span class="p">,</span>
                                   <span class="n">TargetLanguageCode</span><span class="o">=</span><span class="s">'es'</span><span class="p">)[</span><span class="s">'TranslatedText'</span><span class="p">]</span>
</code></pre></div></div>

<p>ì´ êµ¬ì¡°ë¥¼ í†µí•´ ê°„ë‹¨í•œ í•œ ì¤„ì§œë¦¬ë¥¼ ë§Œë“¤ì–´ ì‘ë‹µì—ì„œ ì§ì ‘ ë²ˆì—­ ëœ í…ìŠ¤íŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="detecting-language">Detecting language</h4>

<p>AWS Comprehendë¥¼ ì‚¬ìš©í•˜ì—¬, SourceLanguageCode ìë™ ì„ íƒì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">comprehend</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'comprehend'</span><span class="p">,</span>
                         <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                         <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                         <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">comprehend</span><span class="p">.</span><span class="n">detect_dominant_language</span><span class="p">(</span>
						<span class="n">Text</span><span class="o">=</span><span class="s">'Hay basura por todas partes a lo largo de la carretera.'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì´ë˜í•œ, boto3ì˜ comprehend í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‹œì‘í•©ë‹ˆë‹¤.</p>

<p>ì´í›„ detect_dominant_language ë©”ì†Œë“œë¥¼ ì´ìš©í•´ì„œ, Textë¥¼ ì…ë ¥ë°›ì•„, í•´ë‹¹ ì–¸ì–´ê°€ ì–´ë–¤ ì–¸ì–´ì¸ì§€ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="understanding-sentiment">Understanding sentiment</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span> <span class="o">=</span> <span class="n">comprehend</span><span class="p">.</span><span class="n">detect_sentiment</span><span class="p">(</span><span class="n">Text</span><span class="o">=</span><span class="s">"DataCamp students are amazing."</span><span class="p">,</span>
                                      <span class="n">LanguageCode</span><span class="o">=</span><span class="s">'en'</span><span class="p">)</span>
</code></pre></div></div>

<p>ìœ„ì™€ ë™ì¼í•˜ê²Œ comprehend ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©°, Textì™€ í•´ë‹¹ ì–¸ì–´ë¥¼ ì…ë ¥ë°›ìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h4 id="final-product">Final Product</h4>

<p>ì§€ë‚œ í•´, ì‹œëŠ” ê±°ë¦¬ì— ìŠ¤ì¿ í„°ë¡œ ë¶€í„° ë§¹ê³µê²©ì„ ë‹¹í–ˆìŠµë‹ˆë‹¤. ë§ì€ ì£¼ë¯¼ë“¤ì´ ì¬ë¯¸ìˆëŠ” êµí†µ ìˆ˜ë‹¨ì„ ì¦ê¸°ë©´ì„œ, ì‹œì˜íšŒëŠ” ë…¸ì¸ê³¼ ì¥ì• ê°€ìˆëŠ” ì£¼ë¯¼ë“¤ë¡œë¶€í„° ë” ë‚˜ì€ ê·œì œë¥¼ ë°›ì•„ì•¼í•œë‹¤ëŠ” ì••ë ¥ì„ ë°›ê³  ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì‚¬ëŒë“¤ì€ ì¢…ì¢… ê¸¸ê±°ë¦¬ì—ë‘ê³  ê¸¸ì„ ë§‰ìŠµë‹ˆë‹¤. ì‹œì˜íšŒëŠ” ë„ì‹œê°€ ë³´ë„ë¥¼ ë§‰ëŠ” ìŠ¤ì¿ í„°ë¥¼ ì§‘ì–´ ì˜¬ë¦¬ëŠ” ì •ì±…ì„ í†µê³¼ì‹œí‚¬ ê²ƒì¸ì§€ì— ëŒ€í•´ í† ë¡ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜, ì‹œì˜íšŒì— ì¶œì„í•˜ëŠ” ì‚¬ëŒë“¤ì€ ë„ì‹œ ì¸êµ¬ í†µê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê²½í–¥ì´ ì—†ìœ¼ë©°, ì‹œì˜íšŒëŠ” ìš”ì²­ì„ ê²€í† í•˜ì—¬ ë„ì‹œê°€ í”½ì—…í•´ì•¼í•  ìŠ¤ì¿ í„°ì˜ ì–‘ì„ ì¶”ì •í•˜ë„ë¡ ìš”ì²­í–ˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<ul>
  <li>Initialize boto3 service clients.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rekog</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'rekognition'</span><span class="p">,</span>
                    <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                    <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                    <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">comprehend</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'comprehend'</span><span class="p">,</span>
                    <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                    <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                    <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>

<span class="n">translate</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">'translate'</span><span class="p">,</span>
                    <span class="n">region_name</span><span class="o">=</span><span class="s">'us-east-1'</span><span class="p">,</span>
                    <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_KEY_ID</span><span class="p">,</span>
                    <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET</span><span class="p">)</span>
</code></pre></div></div>

<p>ë¨¼ì € í´ë¼ì´ì–¸íŠ¸ ì„¤ì •ì„ ì§„í–‰í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<p>-Translate all descriptions to English</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="p">.</span><span class="n">iterrows</span><span class="p">():</span>
  <span class="n">desc</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'public_description'</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">desc</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">translate_fake</span><span class="p">.</span><span class="n">translate_text</span><span class="p">(</span><span class="n">Text</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span>
                                        <span class="n">SourceLanguageCode</span><span class="o">=</span><span class="s">'auto'</span><span class="p">,</span>
                                        <span class="n">TargetLanguageCode</span><span class="o">=</span><span class="s">'en'</span><span class="p">)</span>
    <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s">'public_description'</span><span class="p">]</span> <span class="o">=</span> <span class="n">resp</span><span class="p">[</span><span class="s">'TranslatedText'</span><span class="p">]</span>
</code></pre></div></div>

<p>í˜„ì¬ ë‹¤ì–‘í•œ ì–¸ì–´ë¡œ ì‘ì„±ë˜ì–´ìˆëŠ” ì–¸ì–´ë¥¼, í•˜ë‚˜ì˜ ì–¸ì–´ë¡œ ë²ˆì—­í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<ul>
  <li>Detect text sentiment</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="p">.</span><span class="n">iterrows</span><span class="p">():</span>
  <span class="n">desc</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'public_description'</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">desc</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">comprehend</span><span class="p">.</span><span class="n">detect_sentiment</span><span class="p">(</span><span class="n">Text</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span>
                                      <span class="n">LanguageCode</span><span class="o">=</span><span class="s">'en'</span><span class="p">)</span>
    <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'sentiment'</span><span class="p">]</span> <span class="o">=</span> <span class="n">resp</span><span class="p">[</span><span class="s">'Sentiment'</span><span class="p">]</span>
</code></pre></div></div>

<p>ì´í›„, ì„¤ëª…ì—ì„œ í…ìŠ¤íŠ¸ì˜ ê°ì •ì„ ê°ì§€í•˜ê¸° ìœ„í•´ DataFrameì˜ ëª¨ë“  í–‰ì„ ë°˜ë³µí•©ë‹ˆë‹¤.</p>

<p><br /></p>

<ul>
  <li>Detect scooter in image</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'img_scooter'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="p">.</span><span class="n">iterrows</span><span class="p">():</span>
  <span class="n">image</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'image'</span><span class="p">]</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">rekog</span><span class="p">.</span><span class="n">detect_labels</span><span class="p">(</span>
  	<span class="n">Image</span><span class="o">=</span><span class="p">{</span><span class="s">'S3Object'</span><span class="p">:</span> <span class="p">{</span><span class="s">'Bucket'</span><span class="p">:</span> <span class="s">'gid-images'</span><span class="p">,</span> <span class="s">'Name'</span><span class="p">:</span> <span class="n">image</span><span class="p">}}</span>
  <span class="p">)</span>
  <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s">'Labels'</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">label</span><span class="p">[</span><span class="s">'Name'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Scooter'</span><span class="p">:</span>
      <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'img_scooter'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">break</span>
</code></pre></div></div>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ, ì €ì¥í•œ ëª¨ë“  ì´ë¯¸ì§€ì— ëŒ€í•´, Rekognitionë ˆì´ë¸” ê°ì§€ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<ul>
  <li>Final count</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pickups</span> <span class="o">=</span> <span class="n">df</span><span class="p">[((</span><span class="n">df</span><span class="p">.</span><span class="n">img_scooter</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">sentiment</span> <span class="o">==</span><span class="s">'NEGATIVE'</span><span class="p">))]</span>

<span class="n">num_pickups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pickups</span><span class="p">)</span>
</code></pre></div></div>

<p>ìŠ¤ì¿ í„°ê°€ ê°ì§€ ë˜ê³ , ë¶€ì •ì˜ ê°ì •ì„ ê°€ì§„ ëª¨ë“  í–‰ì„ í”½ì—… ë°ì´í„° í”„ë ˆì„ì— ì €ì¥í•˜ê³  ê·¸ ìˆ˜ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.</p>

:ET