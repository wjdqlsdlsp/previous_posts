I"£Ó<h1 id="ë°ì´í„°-ë‹¤ë£¨ê¸°">ë°ì´í„° ë‹¤ë£¨ê¸°</h1>

<h1 id="importing-data-from-flat-files">Importing Data from Flat Files</h1>

<p>ë°ì´í„° ìˆ˜ì§‘ì—†ì´ëŠ”, Data Science or Data Analyticê³¼ì •ì— ì ‘ê·¼ í•  ìˆ˜ì—†ë‹¤.</p>

<p><br /></p>

<h3 id="pandas">Pandas</h3>
<ul>
  <li>
    <p>2008ë…„ Wes Mckinneyì— ì˜í•´ ì œì‘</p>
  </li>
  <li>
    <p>ì´ˆê¸°ì—ëŠ” ì¬ì •ì  ì •ëŸ‰í™”ë¥¼ ìœ„í•´ ê°œë°œ</p>
  </li>
  <li>
    <p>ì˜¤ëŠ˜ë‚  ëŒ€ê·œëª¨ ê°œë°œ ì»¤ë®¤ë‹ˆí‹° ë¶„ì•¼ì—ì„œ ì‚¬ìš©</p>
  </li>
  <li>
    <p>íŒë‹¤ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„°ë¥¼ ì‰½ê²Œ ë¡œë“œí•˜ê³  ì¡°ì‘ í•  ìˆ˜ ìˆìœ¼ë©°, ë¶„ì„ ë° ì‹œê°í™” ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ í†µí•©ë˜ì–´ ì‰½ê²Œ ì‚¬ìš© ê°€ëŠ¥</p>
  </li>
</ul>

<p><br /></p>

<h3 id="dataframe">DataFrame</h3>
<ul>
  <li>
    <p>Pandasì˜ ì¤‘ì‹¬ ìë£Œí˜•</p>
  </li>
  <li>
    <p>2ì°¨ì› ë°ì´í„° êµ¬ì¡° ( ì—´ - column labels ê³¼ í–‰ - row labels ì„ ê°€ì§ )</p>
  </li>
  <li>
    <p>pandasëŠ” ë‹¤ì–‘í•œ ë°ì´í„° í˜•ì‹ì„ ì²˜ë¦¬</p>
  </li>
</ul>

<p><br /></p>

<h3 id="flat-files">Flat Files</h3>
<ul>
  <li>ë§¤ìš° ê°„ë‹¨í•œ êµ¬ì¡°ë¡œ, ë°ì´í„° ì €ì¥ ë° ê³µìœ ì— ë„ë¦¬ ì‚¬ìš©</li>
  <li>Flat file ë°ì´í„°ëŠ” ìƒ‰ìƒì´ë‚˜ ê¸€ê¼´ê°™ì€ ì„œì‹ ì—†ì´, ì¼ë°˜ í…ìŠ¤íŠ¸ë¡œ ì €ì¥</li>
  <li>ê° í–‰ì€, êµ¬ë¶„ ê¸°í˜¸(delimiter) ë¼ê³  ë¶ˆë¦¬ëŠ” ë¬¸ìë¡œ êµ¬ë¶„í•˜ì—¬ í•œ í–‰ì„ ë‚˜íƒ€ëƒ„</li>
  <li>ì¼ë°˜ì ì¸ êµ¬ë¶„ê¸°í˜¸ëŠ” ì‰¼í‘œ(,)  - ì´ ì™¸ì— ê°’ë„ ì‚¬ìš© ê°€ëŠ¥</li>
</ul>

<p><br />
ex) delimiterê°€ ì‰¼í‘œì¼ë•Œ</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">tax_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"us_tax_data.csv"</span><span class="p">)</span>
<span class="n">tax_data</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>
<p><br />
ex) delimiterê°€ íƒ­ì¼ë•Œ</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">tax_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"us_tax_data.tsv"</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">)</span>
<span class="n">tax_data</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="modifying-flat-file-imports">Modifying flat file imports</h2>
<p><br /></p>
<h3 id="usecols">usecols</h3>
<p><br />
usecols íŒŒë¼ë¯¸í„°ë¥¼ ì´ìš©í•´ì„œ, ì›í•˜ëŠ” columnë§Œ ë¡œë“œí•  ìˆ˜ ìˆìŒ</p>

<p>ex) column ì´ë¦„ìœ¼ë¡œ ë¡œë“œ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'STATEFIPS'</span><span class="p">,</span> <span class="s">'STATE'</span><span class="p">,</span> <span class="s">'zipcode'</span><span class="p">,</span> <span class="s">'agi_stub'</span><span class="p">,</span> <span class="s">'N1'</span><span class="p">]</span>
<span class="n">tax_data_v1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"us_tax_data.csv"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="n">col_names</span> <span class="p">)</span>
</code></pre></div></div>
<p><br />
ex) column ë²ˆí˜¸ë¡œ ë¡œë“œ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">col_nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">tax_data_v2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"us_tax_data.csv"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="n">col_nums</span> <span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="nrows">nrows</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tax_data_first1000</span> <span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"us_tax_data.csv"</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div></div>

<p>nrows : ëª‡ë²ˆì§¸ rowê¹Œì§€ ë¡œë“œí•  ê²ƒì¸ì§€</p>

<p>skiprows : ë°ì´í„°ë¥¼ ë¡œë“œí• ë•Œ, ëª‡ë²ˆì§¸ ë¶€í„° ê°€ì ¸ì˜¬ì§€</p>

<p>ex ) nrows 500, skiprows = 1000 =&gt; 1000í–‰ ~ 1500í–‰ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´</p>

<p><br /></p>
<h3 id="header">header</h3>

<p><code class="language-plaintext highlighter-rouge">header = None</code> : í—¤ë”ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì§€ì•ŠëŠ”ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">col_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tax_data_first_1000</span><span class="p">)</span>
<span class="n">tax_data_next500</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"us_tax_data.csv"</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">col_names</span><span class="p">)</span>
</code></pre></div></div>

<p>skiprows í•˜ë©´ header ì •ë³´ë¥¼ ë¹¼ë†“ê³  ë¡œë“œí•˜ëŠ”ë°, ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ê°™ì´ names ë¥¼ ì´ìš©
<br /></p>

<h2 id="common-errors">Common Errors</h2>
<ol>
  <li>ë¶„ì„ì„ ë°©í•´ í•  ìˆ˜ ìˆëŠ” ì˜ëª»ëœ ì—´ ë°ì´í„° ìœ í˜•</li>
  <li>ê²°ì¸¡ ê°’</li>
  <li>íŒë‹¤ìŠ¤ë¡œ ì½ì„ ìˆ˜ ì—†ëŠ” í˜•ì‹</li>
</ol>

<p><br /></p>

<h3 id="1-specifying-data-types">1. Specifying Data Types</h3>

<p>ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ, PandasëŠ” ê° ì—´ì˜ ë°ì´í„° ìœ í˜•ì„ ìœ ì¶”í•˜ëŠ”ë°, ë•Œë¡œëŠ” ì˜ëª» ìœ ì¶”</p>

<p>ì´ë¥¼ ë§‰ê¸° ìœ„í•´ì„œ, <code class="language-plaintext highlighter-rouge">dtype</code> ì„í†µí•´ ì§ì ‘ ë°ì´í„° ìœ í˜•ì„ ì„ ì–¸</p>

<p><code class="language-plaintext highlighter-rouge">tax_data = pd.read_csv("us_tax_data.csv", dtype ={"zipcode":str})</code></p>

<p><br /></p>

<h3 id="2-customizing-missing-data-values">2. Customizing Missing Data Values</h3>

<p>Pandas ëŠ” N/A ë˜ëŠ” null ê³¼ ê°™ì€ ì¼ë¶€ ê°’ì„ ìë™ìœ¼ë¡œ ì¸ì‹</p>

<p>ëˆ„ë½ëœ ë°ì´í„°ë¥¼ ë°ì´í„° ì •ë¦¬ ê¸°ëŠ¥ì„ ì´ìš©í•˜ì—¬ ìë™ìœ¼ë¡œ ì •ë¦¬.</p>

<p>í•˜ì§€ë§Œ ë•Œë•Œë¡œ ëˆ„ë½ ëœ ê°’ì„ í¬ì°©í•˜ì§€ ëª»í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í‘œí˜„</p>

<p>ì´ëŸ¬í•œ NA values í‚¤ì›Œë“œ ì¸ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ ëˆ„ë½ ëœ ë°ì´í„°ë¥¼ ê³ ë ¤í•˜ë„ë¡ Pandasì—ê²Œ ì§€ì‹œê°€ëŠ¥</p>

<p><code class="language-plaintext highlighter-rouge">tax_data = pd.read_csv("us_tax_data.csv", na_values = {"zipcode":0})</code></p>

<p><br /></p>

<h3 id="3-lines-with-errors">3. Lines with Errors</h3>

<p>Pandasê°€ íŒŒì‹± í•  ìˆ˜ ì—†ëŠ” ì¤„, ex ) ë ˆì½”ë“œì— ìˆëŠ” ê²ƒë³´ë‹¤ ë” ë§ì€ ê°’ì„ ê°€ì§„ ê²½ìš°</p>

<p>ì´ëŸ° ê²½ìš°ëŠ” <code class="language-plaintext highlighter-rouge">error_bad_lines</code> ì™€ <code class="language-plaintext highlighter-rouge">warn_bad_lines</code> ë¥¼ ì´ìš©í•˜ì—¬ í•´ê²°</p>

<p><code class="language-plaintext highlighter-rouge">error_bad_lines = False</code> : ì˜¤ë¥˜ë¡œ ì˜ëª»ëœ ì¤„ì„ Falseë¡œ í•  ê²½ìš°, Pandasê°€ ê±´ë„ˆ ëœë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">warn_bad_lines = True</code> : íŒŒì‹± í•  ìˆ˜ ì—†ëŠ” ì¤„ì„ ê±´ë„ˆ ë›¸ ë•Œ ë©”ì‹œì§€ë¥¼ í‘œì‹œ</p>

<p><br /></p>

<hr />

<h1 id="introduction-to-spreadsheets">Introduction to spreadsheets</h1>
<h3 id="spreadsheets">Spreadsheets</h3>
<ul>
  <li>Excel íŒŒì¼ë¡œ ì˜ ì•Œë ¤ì ¸ìˆë‹¤.</li>
  <li>ë°ì´í„°ëŠ” í–‰ê³¼ ì—´ì˜ í…Œì´ë¸” í˜•íƒœ</li>
  <li>Flat filesê³¼ ë‹¤ë¥´ê²Œ ì„œì‹ë„ ì§€ì›í•œë‹¤.</li>
  <li>Excel íŒŒì¼ ë˜ëŠ” í†µí•© ë¬¸ì„œì—ëŠ” ì—¬ëŸ¬ê°œì˜ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ê°€ ìˆì„ ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><br /></p>

<h3 id="loading-spreadsheets">Loading Spreadsheets</h3>

<p><code class="language-plaintext highlighter-rouge">survey_data = pd.read_excel("fcc_surcey.xlsx")</code></p>

<p>ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ ìë£ŒëŠ”, ê¸°ê³„ê°€ ì½ê¸° ì–´ë µë‹¤.</p>

<p>ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ í‘œí˜•ì‹ì´ ì•„ë‹Œ ì •ë³´ê°€ í‘œí•¨ëœë‹¤. ex) ë©”íƒ€ ë°ì´í„°, í—¤ë”, ì¸ë³´ì´ìŠ¤ ë“±</p>

<p>CSVì™€ ë§ˆì°¬ê°€ì§€ë¡œ Excel ì½ê¸°ì—ì„œë„ ì´ëŸ¬í•œ ë¶€ë¶„ì„ ê±´ë„ˆë›°ê±°ë‚˜ ì œí•œí•˜ì—¬ ì›í•˜ëŠ” í–‰, ì—´ë§Œ ê°€ì ¸ì˜¬ìˆ˜ìˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">nrows</code> : csvì™€ ë™ì¼í•˜ê²Œ í–‰ì˜ ì •ìˆ˜ë¥¼ ì·¨í•¨</p>

<p><code class="language-plaintext highlighter-rouge">skiprows</code> : ë™ì¼í•˜ê²Œ, ê±´ë„ˆ ë›¸ í–‰ ë²ˆí˜¸ë¥¼ ì·¨í•¨</p>

<p><code class="language-plaintext highlighter-rouge">usecols</code> : ì—´ ë²ˆí˜¸, ì—´ ì´ë¦„ë¥¼ ì·¨í•¨( CSV ì™€ ë‹¤ë¥¸ì  : â€œA:Pâ€ ì™€ ê°™ì´ ë¬¸ìì˜ ë²”ìœ„ë„ ê°€ëŠ¥)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">survey_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey_with_headers.xlsx"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="s">"W:AB, AR"</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="getting-data-from-multiple-worksheets">Getting data from multiple worksheets</h3>

<p>Excel íŒŒì¼ì—ëŠ” ì—¬ëŸ¬ ì¥ì˜ ë°ì´í„°ê°€ í¬í•¨ë˜ëŠ” ê²ƒì€ ë§¤ìš° ì¼ë°˜ì </p>

<p>ê¸°ë³¸ì ìœ¼ë¡œ Excel ì½ê¸°ëŠ”, í†µí•© ë¬¸ì„œì˜ ì²« ë²ˆì§¸ ì‹œíŠ¸ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´</p>

<p><code class="language-plaintext highlighter-rouge">sheet_name</code> : íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´, ì‹œíŠ¸ ì´ë¦„ í‚¤ì›Œë“œ ì¸ìˆ˜ë¡œ ë³€ê²½</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">survey_data_sheet2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey.xlsx"</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">----------</span>
<span class="n">survey_data_2017</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey.xlsx"</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s">"2017"</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="loading-all-sheets">Loading All Sheets</h3>
<p><code class="language-plaintext highlighter-rouge">sheet_name = None</code> ì„ ì´ìš©</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">survey_responses</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey.xlsx"</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div>

<p>dict í˜•ì‹ìœ¼ë¡œ ì €ì¥</p>

<p><br /></p>

<h3 id="putting-it-all-together">Putting It All Together</h3>

<p>ë‚˜ëˆ ì ¸ ìˆëŠ” ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ í•˜ë‚˜ì˜ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">all_responses</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">survey_responses</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">frame</span><span class="p">[</span><span class="s">"Year"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sheet_name</span>
    <span class="n">all_responses</span> <span class="o">=</span> <span class="n">all_responses</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="modifying-imports--truefalse-data">Modifying imports : true/false data</h3>

<p>Pandas ëŠ” Booleans ë°ì´í„°ë¥¼ bool ìë£Œí˜•ìœ¼ë¡œ ì²˜ë¦¬í•˜ì§€ì•ŠìŒ.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bool_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey_booleans.xlsx"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span> <span class="p">{</span><span class="s">"AttendedBootCamp"</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="s">"AttendedBootCampYesNo"</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">})</span>
</code></pre></div></div>

<p>pandas ëŠ” boolean ë°ì´í„°ì—ì„œ, NaN ê°’ì„ Trueë¡œ ì²˜ë¦¬</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bool_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey_booleans.xlsx"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span> <span class="p">{</span><span class="s">"AttendedBootCamp"</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="s">"AttendedBootCampYesNo"</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">},</span> <span class="n">true_value</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Yes"</span><span class="p">],</span> <span class="n">false_value</span> <span class="o">=</span> <span class="p">[</span><span class="s">"No"</span><span class="p">])</span>
</code></pre></div></div>

<p>ì´ë¥¼ ì‚¬ìš©í•˜ë©´ NaNê°’ìœ¼ë¡œ í‘œì‹œ</p>

<p><br /></p>

<h3 id="modifying-imports--parsing-dates">Modifying imports : parsing dates</h3>

<p>íŒŒì´ì¬ì€ ë‚ ì§œ ì‹œê°„í˜•ì‹ì„, íŠ¹ìˆ˜ ë°ì´í„° ìœ í˜•ì¸ datetimeìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.</p>

<p>datetimes ëŠ” ë¬´ìˆ˜íˆ ë§ì€ í‘œí˜„ìœ¼ë¡œ ë‚˜íƒ€ ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ê¸°ë³¸ì ìœ¼ë¡œ datetime ë°ì´í„°ë¥¼ objectíƒ€ì…ìœ¼ë¡œ ë¡œë“œ</p>

<p>ë§Œì•½ datetimeê´€ë ¨ ì—°ì‚°ì„ í•˜ê³ ì‹¶ë‹¤ë©´, <code class="language-plaintext highlighter-rouge">parse_dates</code> í‚¤ì›Œë“œ ë³€ìˆ˜ë¥¼ ì‚¬ìš© (<code class="language-plaintext highlighter-rouge">dtype</code> ì´ ì•„ë‹˜ì„ ì£¼ëª©)</p>

<p><code class="language-plaintext highlighter-rouge">parse_dates</code>ëŠ” íŒŒì‹± í•  ì—´ ì´ë¦„ ë˜ëŠ” ìˆ«ì, ë¦¬ìŠ¤íŠ¸ í˜•ì„ í—ˆìš©</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">date_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Part1StartTime"</span><span class="p">,</span> <span class="s">"Part1EndTime"</span><span class="p">]</span>
<span class="n">survey_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey.xlsx"</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="n">date_cols</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">date_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Part1StartTime"</span><span class="p">,</span> <span class="s">"Part1EndTime"</span><span class="p">,</span> <span class="p">[[</span><span class="s">"Part2StartDate"</span><span class="p">,</span> <span class="s">"Part2StartTime"</span><span class="p">]]]</span>
<span class="n">survey_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey.xlsx"</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="n">date_cols</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">date_cols</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Part1Start"</span><span class="p">:</span><span class="s">"Part1StartTime"</span><span class="p">,</span> <span class="s">"Part1End"</span><span class="p">:</span><span class="s">"Part1EndTime"</span><span class="p">,</span> <span class="s">"Part2Start"</span><span class="p">:[</span><span class="s">"Part2StartDate"</span><span class="p">,</span><span class="s">"Part2StartTime"</span><span class="p">]}</span>
<span class="n">survey_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"fcc_survey.xlsx"</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="n">date_cols</span><span class="p">)</span>
</code></pre></div></div>
<p>ì´ëŸ¬í•œ í˜•ì‹ì€ pandasê°€ ì½ì„ ìˆ˜ ìˆëŠ” í˜•íƒœì¼ ë•Œ ì‘ë™í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h3 id="non-standard-dates">Non-Standard Dates</h3>

<p>ë¹„ì •ìƒì ì¸ ë‚ ì§œì™€ í˜•ì‹ì„ ë¶„ì„í•˜ë ¤ëŠ” ê²½ìš°, objectíƒ€ì…ìœ¼ë¡œ ë¡œë“œí•œ ë’¤,</p>

<p><code class="language-plaintext highlighter-rouge">to_datetime()</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚ ì§œ í˜•ì‹ìœ¼ë¡œ ë³€ê²½</p>

<p><br /></p>

<h3 id="datetime-formatting">Datetime Formatting</h3>

<table>
  <thead>
    <tr>
      <th>Code</th>
      <th>Meaning</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>%Y</td>
      <td>Year(4-digit)</td>
      <td>1999</td>
    </tr>
    <tr>
      <td>%m</td>
      <td>Month(zero-padded)</td>
      <td>03</td>
    </tr>
    <tr>
      <td>%d</td>
      <td>Day(zero-padded)</td>
      <td>01</td>
    </tr>
    <tr>
      <td>%H</td>
      <td>Hour(24-hour clock)</td>
      <td>21</td>
    </tr>
    <tr>
      <td>%M</td>
      <td>Minute(zero-padded)</td>
      <td>09</td>
    </tr>
    <tr>
      <td>%S</td>
      <td>Second(zero-padded)</td>
      <td>05</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h3 id="parsing-non-standard-dates">Parsing Non-Standard Dates</h3>

<p>ex) 03292016 21:27:25</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">format_string</span> <span class="o">=</span> <span class="s">"%m%d%Y %H:%M:%S"</span>
<span class="n">survey_df</span><span class="p">[</span><span class="s">"Part2EndTime"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">survey_df</span><span class="p">[</span><span class="s">"Part2EndTime"</span><span class="p">],</span> <span class="nb">format</span> <span class="o">=</span> <span class="n">format_string</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h1 id="introduction-to-databases">Introduction to databases</h1>

<ul>
  <li>ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” í…Œì´ë¸”ì˜ ì—”í‹°í‹°ì— ëŒ€í•œ ë°ì´í„°ë¥¼ êµ¬ì„±.</li>
  <li>ë°ì´í„° í”„ë ˆì„, í”Œë« íŒŒì¼ ë° ë§ì€ Excel ì‹œíŠ¸ê°€ ë¹„ìŠ·í•œ ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì •ë ¬</li>
  <li>ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê³ ìœ í•œ ë ˆì½”ë“œ ì‹ë³„ì ë˜ëŠ” í‚¤ë¥¼ í†µí•´ í…Œì´ë¸”ì„ <span style="color:green"> ì—°ê²°í•˜ê±°ë‚˜ ê´€ë ¨ ì‹œí‚¬ ìˆ˜ ìˆë‹¤ </span>ëŠ”ê²Œ ì°¨ì´ì </li>
  <li>ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë˜ëŠ” í”Œë«íŒŒì¼ë³´ë‹¤ ë” ë§ì€ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê³  ë” ë§ì€ ì‚¬ìš©ìë¥¼ ì§€ì› + ë”ë§ì€ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì œê³µ</li>
</ul>

<p>SQL(Structured Query Language) ë¥¼ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì¸í„°í˜ì´ìŠ¤í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h3 id="common-relational-databases">Common Relational Databases</h3>
<ul>
  <li>Microsoft SQL server</li>
  <li>ORACLE</li>
  <li>PostgreSQL</li>
  <li>SQLite</li>
</ul>

<p><br /></p>

<p>ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ì™€ ë‹¬ë¦¬ SQLite ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì¼ë°˜ ìì²´ í¬í•¨ ëœ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì €ì¥</p>

<p>CSV ë° Excel íŒŒì¼ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ì»´í“¨í„° íŒŒì¼ë„ ë°ì´í„° ê³µìœ ì— ì í•©</p>

<p><br /></p>

<h3 id="connecting-to-databases">Connecting to Databases</h3>

<ol>
  <li>
    <p>ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì„ ë§Œë“ ë‹¤.</p>
  </li>
  <li>
    <p>SQL ë° Pandasë¥¼ ì´ìš©í•œ ì¿¼ë¦¬ì´ìš©</p>
  </li>
</ol>

<p>ì´ë¥¼ ìœ„í•´ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì™€ í•¨ê»˜ SQLAlchemy ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©</p>

<p><br /></p>

<h3 id="creating-a-database-engine">Creating a Database Engine</h3>

<p><code class="language-plaintext highlighter-rouge">sqlalchemy</code> ì˜ <code class="language-plaintext highlighter-rouge">create_engine()</code> ë¥¼ ì´ìš©í•˜ì—¬,</p>

<p>ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ URL(ë¬¸ìì—´)ë¥¼ ì…ë ¥í•´, ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ ê´€ë¦¬í•˜ëŠ” ì—”ì§„ì„ ë§Œë“¬</p>

<p>URLì€ ë°ì´í„°ë² ì´ìŠ¤ì— ë”°ë¼ ì•½ê°„ì”© ë‹¤ë¥¸ íŒ¨í„´ì„ ê°€ì§.</p>

<p><code class="language-plaintext highlighter-rouge">sqlite:///filename.db</code></p>

<p><br /></p>

<h3 id="querying-databases">Querying Databases</h3>

<p><code class="language-plaintext highlighter-rouge">pd.read_sql(query, engine)</code>ë¥¼ì´ìš©í•˜ì—¬, ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">query</code> : SQLì¿¼ë¦¬ì˜ ë¬¸ìì—´ì´ê±°ë‚˜, ì „ì²´ í…Œì´ë¸”ì„ë¡œë“œí•˜ë ¤ëŠ” ê²½ìš° í…Œì´ë¸”ì˜ ì´ë¦„</p>

<p><code class="language-plaintext highlighter-rouge">engine</code> : ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•</p>

<p><br /></p>

<h3 id="sql-review--select">SQL Review : SELECT</h3>

<p><code class="language-plaintext highlighter-rouge">SELECT [coulumn_names] FROM [table_name]; </code> - ì§€ì •ëœ ì—´ì— ëŒ€í•œ ëª¨ë“  í–‰ì„ ë¡œë“œ</p>

<p><code class="language-plaintext highlighter-rouge">SELECT * FROM [table_name];</code> - í•´ë‹¹ í…Œì´ë¸”ì— ëª¨ë“  ì •ë³´ë¥¼ ë¡œë“œ</p>

<p>ì¼ë°˜ì ìœ¼ë¡œ ëŒ€ì†Œ ë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ë§Œ, ëª¨ë‘ ëŒ€ë¬¸ìë¡œ ì…ë ¥í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì  + ì„¸ë¯¸í´ë¡ ìœ¼ë¡œ SQL ë¬¸ì˜ ëì„ í‘œì‹œí•˜ëŠ” ê²ƒì´ ëª¨ë²”ì </p>

<p><br /></p>

<h3 id="getting-data-from-a-database">Getting Data from a Database</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">"sqlite:///data.db"</span><span class="p">)</span>
<span class="n">weather</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s">"weather"</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>  <span class="c1"># case 1
</span><span class="o">----------------</span>
<span class="n">weather</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s">"SELECT * FROM weather"</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span> <span class="c1"># case 2
</span></code></pre></div></div>
<p><br /></p>

<h2 id="refining-imports-with-sql-queries">Refining imports with SQL queries</h2>

<h3 id="selecting-columns">SELECTing Columns</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="p">[</span><span class="k">column</span> <span class="k">names</span><span class="p">]</span>
<span class="k">FROM</span> <span class="p">[</span><span class="k">table</span> <span class="n">name</span><span class="p">];</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">SELECT date, tavg FROM weather;</code></p>

<p><br /></p>

<h3 id="where-clauses">WHERE Clauses</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="p">[</span><span class="n">column_names</span><span class="p">]</span>
<span class="k">FROM</span> <span class="p">[</span><span class="k">table_name</span><span class="p">]</span>
<span class="k">WHERE</span> <span class="p">[</span><span class="n">condition</span><span class="p">];</span>
</code></pre></div></div>
<p><br /></p>

<h4 id="filtering-by-numbers">Filtering by Numbers</h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">=</code></li>
  <li><code class="language-plaintext highlighter-rouge">&gt;</code> and <code class="language-plaintext highlighter-rouge">&gt;=</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;</code> and <code class="language-plaintext highlighter-rouge">&lt;=</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;&gt;</code> (not equal to)</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">weather</span>
<span class="k">WHERE</span> <span class="n">tmax</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">;</span>
</code></pre></div></div>
<p><br /></p>

<h4 id="filtering-text">Filtering Text</h4>

<p><code class="language-plaintext highlighter-rouge">=</code> ë¥¼ì´ìš©í•˜ì—¬, ë¬¸ìì—´ í•„í„°ë§ ê°€ëŠ¥</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">hpd311calls</span> 
<span class="k">WHERE</span> <span class="n">borough</span> <span class="o">=</span> <span class="s1">'BROOKLYN'</span><span class="p">;</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="sql-and-pandas">SQL and pandas</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">"sqlite:///data.db"</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s">"""
        SELECT * 
        FROM hpd311calls 
        WHERE borough ='BROOKLYN;
        """</span>
<span class="n">brooklyn_calls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="combining-conditions--and">Combining Conditions : AND</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">and_query</span> <span class="o">=</span> <span class="s">"""
            SELECT *
            FROM hpd311calls
            WHERE borough ='BRONX'
            AND complaint_type ='PLUMBING';
            """</span>

<span class="n">bx_plumbing_calls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">and_query</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="combining-conditions--or">Combining Conditions : OR</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">or_query</span> <span class="o">=</span> <span class="s">"""
            SELECT * 
            FROM hpd311calls
            WHERE complaint_type ='WATER LEAK'
            OR complaint_type ='PLUMBING';
            """</span>

<span class="n">bx_plumbing_calls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">or_query</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="more-complex-sql-queries">More complex SQL queries</h2>

<h3 id="getting-distinct-values">Getting DISTINCT values</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="p">[</span><span class="k">column</span> <span class="k">names</span><span class="p">]</span>
<span class="k">FROM</span> <span class="p">[</span><span class="k">table</span><span class="p">];</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="p">[</span><span class="k">table</span><span class="p">];</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">incident_address</span><span class="p">,</span> <span class="n">borough</span>
<span class="k">FROM</span> <span class="n">hpd311calls</span><span class="p">;</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="aggregate-functions">Aggregate Functions</h3>
<ul>
  <li>SUM</li>
  <li>AVG</li>
  <li>MAX</li>
  <li>MIN</li>
  <li>COUNT</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">weather</span><span class="p">;</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="p">[</span><span class="k">table_name</span><span class="p">];</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT COUNT(DISTINCT [column_names])
FROM [table_name];
</code></pre></div></div>
<p><br /></p>

<h3 id="group-by">GROUP BY</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">borough</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">hpd311calls</span>
<span class="k">WHERE</span> <span class="n">complaint_type</span> <span class="o">=</span><span class="s1">'PLUMBING'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">borough</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s">"sqlite:///data.db"</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s">""" 
        SELECT borough, COUNT(*)
        FROM hpd311calls 
        WHERE complaint_type = 'PLUMBING' 
        GROUP BY borough; 
        """</span>
<span class="n">plumbing_call_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="loading-multiple-tables-with-joins">Loading multiple tables with joins</h3>

<p>ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì˜ í•œ ê°€ì§€ ê¸°ëŠ¥ì€ ê³ ìœ  í•œ ë ˆì½”ë“œ ì‹ë³„ì ë˜ëŠ” í‚¤ë¥¼ í†µí•´ í…Œì´ë¸”ì„ ì„œë¡œ ì—°ê²°í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒ</p>

<p><br /></p>

<h3 id="keys">Keys</h3>

<p>ì¼ë°˜ì ìœ¼ë¡œ, ë ˆì½”ë“œë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ëŠ” í‚¤ê°€ ìˆìŒ.</p>

<p>ì´ë¥¼ ì´ìš©í•´, ìë™ìœ¼ë¡œ í–‰ ë²ˆí˜¸ë¥¼ í• ë‹¹</p>

<p><br /></p>

<h3 id="joining-tables">Joining Tables</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">hpd311calls</span>
<span class="k">JOIN</span> <span class="n">weather</span> 
<span class="k">ON</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">created_date</span> <span class="o">=</span> <span class="n">weather</span><span class="p">.</span><span class="nb">date</span><span class="p">;</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="joining-and-filtering">Joining and Filtering</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">hpd311calls</span>
<span class="k">JOIN</span> <span class="n">weather</span>
<span class="k">ON</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">created_date</span> <span class="o">=</span> <span class="n">weather</span><span class="p">.</span><span class="nb">date</span>
<span class="k">WHERE</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">complaint_type</span> <span class="o">=</span> <span class="s1">'HEAT/HOT WATER'</span><span class="p">;</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="joining-and-aggregating">Joining and Aggregating</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">borough</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">hpd311calls</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">borough</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">borough</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">boro_census</span><span class="p">.</span><span class="n">total_population</span><span class="p">,</span> <span class="n">boro_census</span><span class="p">.</span><span class="n">housing_units</span>
<span class="k">FROM</span> <span class="n">hpd311calls</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">borough</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">borough</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">boro_census</span><span class="p">.</span><span class="n">total_population</span><span class="p">,</span> <span class="n">boro_census</span><span class="p">.</span><span class="n">housing_units</span>
<span class="k">FROM</span> <span class="n">hpd311calls</span>
<span class="k">JOIN</span> <span class="n">boro_census</span>
<span class="k">ON</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">borough</span><span class="o">=</span> <span class="n">boro_census</span><span class="p">.</span><span class="n">borough</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">hpd311calls</span><span class="p">.</span><span class="n">borough</span><span class="p">;</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="review">Review</h3>

<ul>
  <li>SELECT</li>
  <li>FROM</li>
  <li>JOIN</li>
  <li>WHERE</li>
  <li>GROUP BY</li>
</ul>

<p><br /></p>

<hr />

<h1 id="introduction-to-json">Introduction to JSON</h1>

<h2 id="javascript-object-notation-json">Javascript Object Notation (JSON)</h2>
<ul>
  <li>ì¼ë°˜ì ìœ¼ë¡œ, ì›¹ ë°ì´í„° í˜•ì‹</li>
  <li>í‘œ í˜•ì‹ X ( ëª¨ë“  ë ˆì½”ë“œê°€ ë™ì¼í•œ ì†ì„± ì§‘í•©ì„ ê°€ì§ˆ í•„ìš”ëŠ” ì—†ë‹¤. )</li>
  <li>ë°ì´í„°ëŠ” ê°œì²´ ëª¨ìŒìœ¼ë¡œ êµ¬ì„± ( íŒŒì´ì¬ ë”•ì…”ë„ˆë¦¬ì™€ ë¹„ìŠ· )</li>
  <li>ì¤‘ì²© ë  ìˆ˜ ìˆìŒ</li>
</ul>

<p><br /></p>

<h3 id="reading-json-data">Reading JSON Data</h3>

<p><code class="language-plaintext highlighter-rouge">read_json()</code> ë¥¼ í†µí•´ DataFrameìœ¼ë¡œ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>JSON ì½ê¸°ëŠ” JSON ê²½ë¡œ ë¬¸ìì—´ì„ ì´ìš© or ë°ì´í„°ë¥¼ ë¬¸ìì—´ë¡œ ì œê³µ</li>
  <li><code class="language-plaintext highlighter-rouge">dtype</code> ì„ í†µí•´ í˜•ì‹ ì§€ì •</li>
  <li><code class="language-plaintext highlighter-rouge">orient</code> ë¥¼ í†µí•´, ë ˆì´ì•„ì›ƒ í”Œë˜ê·¸ë¥¼ ì§€ì •</li>
</ul>

<p><br /></p>

<h3 id="data-orientation">Data Orientation</h3>

<ul>
  <li>JSON ë°ì´í„°ëŠ” í‘œí˜•ì‹ì´ ì•„ë‹ˆë¯€ë¡œ, Pandasê°€ í…Œì´ë¸”ì„ ì–´ë–»ê²Œ ì •ë¦¬í• ì§€ ì¶”ì¸¡.</li>
  <li>PandasëŠ” ê°€ì¥ ìì£¼ ì ‘í•˜ê²Œ ë˜ëŠ” ë ˆì½”ë“œ ë° ì—´ ë°©í–¥ì„ ìë™ìœ¼ë¡œ ê°ì§€</li>
</ul>

<p><br /></p>

<h3 id="record-orientation">Record Orientation</h3>

<ul>
  <li>ë ˆì½”ë“œ ì§€í–¥ JSONì€ ê°ê° í…Œì´ë¸” ë ˆì½”ë“œë¡œ ë³€í™˜ë˜ëŠ” ì‚¬ì „ëª©ë¡ì„ êµ¬ì„±</li>
</ul>

<p><br /></p>

<h3 id="column-orientation">Column Orientation</h3>

<ul>
  <li>ì†ì„± ì´ë¦„ì„ ë°˜ë³µí•˜ì§€ ì•ŠìŒìœ¼ë¡œì¨ íŒŒì¼ í¬ê¸°ë¥¼ ì¤„ì´ê¸° ìœ„í•´ JSONì€ ì—´ ì§€í–¥ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>

<p><br /></p>

<h3 id="specifying-orientation">Specifying Orientation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">death_causes</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_json</span><span class="p">(</span><span class="s">"nyc_death_causes.json"</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span><span class="s">"split"</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="introduction-to-apis">Introduction to APIs</h2>

<h3 id="application-programming-interfaces--api-">Application Programming Interfaces ( API )</h3>

<p>JSON ë°ì´í„°ì˜ ê°€ì¥ ì¼ë°˜ì ì¸ ì†ŒìŠ¤, API</p>

<p>APIëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ê³¼ í†µì‹  í•  ìˆ˜ ìˆëŠ” ì •ì˜ ëœ ë°©ë²•ì´ë©°, ê·¸ ë°˜ëŒ€ì˜ ê²½ìš°ë„ ë™ì¼.</p>

<ul>
  <li>í”„ë¡œê·¸ë˜ë¨¸ê°€ ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.</li>
  <li>í•´ë‹¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°ì´í„°ë² ì´ìŠ¤ ì•„í‚¤í…ì²˜ì— ëŒ€í•´ ì•Œì•„ì•¼í•œë‹¤.</li>
  <li>APIëŠ” ê³µìœ  ë¦¬ì†ŒìŠ¤ì´ë©°, ì§€ì •ëœ ê¸°ê°„ ë™ì•ˆ ì–»ì„ ìˆ˜ ìˆëŠ” ë°ì´í„° ì–‘ì„ ì œí•œí•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤.</li>
</ul>

<p>APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì–»ëŠ” ê²ƒì€ ì¹´íƒˆë¡œê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì œí’ˆì„ ì£¼ë¬¸í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤. ì¹´íƒˆë¡œê·¸ëŠ” ì‚¬ìš© ê°€ëŠ¥í•œ ì œí’ˆì„ ë³´ì—¬ì£¼ê³  ì£¼ë¬¸ ì§€ì¹¨ì„ ì œê³µí•©ë‹ˆë‹¤. ì˜¬ë°”ë¥¸ ì£¼ì†Œë¡œ ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±ëœ ì£¼ë¬¸ì„ ë³´ë‚´ê³ , ì£¼ë¬¸í•œ ê²ƒì„ ë°›ëŠ”ë‹¤.</p>

<p>APIëŠ” ìš”ì²­ì„ ë³´ë‚¼ ì—”ë“œ í¬ì¸íŠ¸ë¥¼ ì œê³µ, ë¬¸ì„œëŠ” í¬í•¨ í•  ë§¤ê°œ ë³€ìˆ˜ì™€ ê°™ì€ ìš”ì²­ì˜ ëª¨ì–‘ì„ ì„¤ëª…</p>

<p><br /></p>

<h3 id="requests">Requests</h3>
<ul>
  <li>ìš”ì²­ì„ í†µí•´ ì‚¬ìš©ìëŠ” ëª¨ë“  URLì—ì„œ ë°ì´í„°ë¥¼ ë³´ë‚´ê³  ë°›ìŒ</li>
  <li>íŠ¹ì • APIì™€ ê´€ê³„ X.</li>
  <li><code class="language-plaintext highlighter-rouge">requests.get()</code> ë¥¼ í†µí•´ URL ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´</li>
</ul>

<p><br /></p>

<h3 id="requestget">request.get()</h3>

<p><code class="language-plaintext highlighter-rouge">requests.get(url_string)</code> ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ URL ë¬¸ìì—´ì„ ì…ë ¥ë°›ìŒ.</p>

<p>API ì‘ì—…ì— ìœ ìš©í•œ íŒŒë¼ë¯¸í„°ë“¤</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">params</code> : ë§¤ê°œ ë³€ìˆ˜ ì´ë¦„ ë° ê°’ ë”•ì…”ë„ˆë¦¬ë¥¼ ì „ë‹¬í•˜ì—¬, API ìš”ì²­ì„ ì‚¬ìš©ì ì •ì˜</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">headers</code> : ë™ì¼í•˜ê²Œ ì´ë¦„ê³¼ ê°’ì„ ì·¨í•¨, ì‚¬ìš©ì¤‘ì¸ APIì— ì‚¬ìš©ì ì¸ì¦ í‚¤ê°€ í•„ìš”í•œ ê²½ìš° í—¤ë”ë¡œ ì „ë‹¬</p>
  </li>
</ul>

<p>ê²°ê³¼ ê°’ì€, <code class="language-plaintext highlighter-rouge">response</code> ê°ì²´ë¡œ, ë°ì´í„°ì™€ ë©”íƒ€ ë°ì´í„°ë¥¼ í¬í•¨</p>

<p>ë°ì´í„°ë§Œ ê°€ì ¸ì˜¤ë ¤ë©´, <code class="language-plaintext highlighter-rouge">response.json()</code>ë¥¼ ì´ìš©</p>

<p><br /></p>

<h3 id="responsejson-and-pandas">response.json() and pandas</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">response.json()</code> : ë”•ì…”ë„ˆë¦¬ ê°’ì„ ë°˜í™˜</li>
  <li><code class="language-plaintext highlighter-rouge">read_json()</code> : ë¬¸ìì—´ ë¡œë“œ ( ë”•ì…”ë„ˆë¦¬ êµ¬ë¬¸ì€ ë¡œë“œí•  ìˆ˜ ì—†ìŒ )</li>
  <li>JSON ë°ì´í„°ë¥¼ DataFrameìœ¼ë¡œ ë¡œë“œí•˜ë ¤ë©´, <code class="language-plaintext highlighter-rouge">pd.DataFrame()</code>ë¥¼ ì´ìš© (<code class="language-plaintext highlighter-rouge">read_json</code> ëŠ” ì˜¤ë¥˜ ë°œìƒ)</li>
</ul>

<p><br /></p>

<h3 id="yelp-business-search-api">Yelp Business Search API</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">api_url</span> <span class="o">=</span> <span class="s">"https://api.yelp.com.v3/businesses/search"</span> <span class="c1"># End point ì§€ì •
</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">"term"</span> <span class="p">:</span> <span class="s">"bookstore"</span><span class="p">,</span><span class="s">"location"</span><span class="p">:</span><span class="s">"San Francisco:"</span><span class="p">}</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Authorization"</span> <span class="p">:</span> <span class="s">"Bearer {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">api_key</span><span class="p">)}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">api_url</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="parsing-responses">Parsing Responses</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
<span class="n">booksores</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'businesses'</span><span class="p">])</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="working-with-nested-jsons">Working with nested JSONs</h2>

<h3 id="nested-jsons">Nested JSONs</h3>

<p>JSONì—ëŠ” ì†ì„± - ê°’ ìŒì´ìˆëŠ” ê°œì²´ê°€ í¬í•¨</p>

<p>JSON ê°’ ìì²´ê°€ ê°ì²´ ì¸ ê²½ìš° JSONì€ ì¤‘ì²©</p>

<p><br /></p>

<h3 id="pandasiojson">Pandas.io.json</h3>
<p>pandas.io.json` í•˜ìœ„ ëª¨ë“ˆì— ì½ê¸° ë° ì“°ê¸° ê¸°ëŠ¥ì´ í¬í•¨</p>

<p><code class="language-plaintext highlighter-rouge">json_normalize()</code> json ì •ê·œí™” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬, ì¤‘ì²© ëœ ë°ì´í„°ë¥¼ í‰ë©´í™”,</p>

<p>JSON ì •ê·œí™”ëŠ” ë”•ì…”ë„ˆë¦¬ ë˜ëŠ” ì‚¬ì „ ëª©ë¡ì„ ì‚¬ìš©</p>

<p>ë°˜í™˜ ê°’ìœ¼ë¡œ, í‰ë©´í™” ë°ì´í„° í”„ë ˆì„</p>

<p>ì¤‘ì²© ëœ ì†ì„± ì—´ ì´ë¦„ì€ ê¸°ë³¸ íŒ¨í„´ ì†ì„± ì  ì¤‘ì²© ëœ ì†ì„±ì„ ë”°ë¦„</p>

<p>ì  êµ¬ë¶„ ê¸°í˜¸ëŠ” ì—´ ì„ íƒì„ ìœ„í•œ pandasì˜ ì  í‘œê¸°ë²•ì„ ë°©í•´í•˜ë¯€ë¡œ,</p>

<p>sep ì¸ìˆ˜ì™€ í•¨ê»˜ ë°‘ì¤„ê³¼ ê°™ì€ ë‹¤ë¥¸ êµ¬ë¶„ ê¸°í˜¸ë¥¼ ì§€ì •í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ</p>

<p><br /></p>

<h3 id="loading-nested-json-data">Loading Nested JSON Data</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">pandas.io.json</span> <span class="kn">import</span> <span class="n">json_normalize</span>

<span class="n">api_url</span> <span class="o">=</span> <span class="s">"https://api.yelp.com.v3/businesses/search"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Authorization"</span> <span class="p">:</span> <span class="s">"Bearer {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">api_key</span><span class="p">)}</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">"term"</span> <span class="p">:</span> <span class="s">"bookstore"</span><span class="p">,</span><span class="s">"location"</span><span class="p">:</span><span class="s">"San Francisco:"</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">api_url</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
<span class="n">bookstores</span> <span class="o">=</span> <span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'businesses'</span><span class="p">],</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">"_"</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="deeply-nested-data">Deeply Nested Data</h3>

<p>ì‚¬ìš©ì ì§€ì • í‰ë©´í™” í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ê±°ë‚˜ ë¶„ì„ê³¼ ê´€ë ¨ì´ ì—†ë‹¤ê³  íŒë‹¨í•˜ì—¬ ê·¸ëŒ€ë¡œ ë‘˜ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">json_normalize()</code>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">record_path</code>  string/list ë ˆì½”ë“œ ê²½ë¡œëŠ” íŒŒì¼ ê²½ë¡œì— í´ë”ë¥¼ ë‚˜ì—´í•˜ëŠ” ê²ƒê³¼ ê°™ì´ ì¤‘ì²© ëœ ë°ì´í„°ì— ëŒ€í•œ ë¬¸ìì—´ ë˜ëŠ” ì†ì„± ë¬¸ìì—´ ëª©ë¡ì„ ì‚¬ìš©</li>
      <li><code class="language-plaintext highlighter-rouge">meta</code> ê²°ê³¼ ë°ì´í„° í”„ë ˆì„ì— í¬í•¨ í•  ìƒìœ„ ë ˆë²¨ ì†ì„± ëª©ë¡ì„ ê°€ì ¸ì˜´,</li>
      <li><code class="language-plaintext highlighter-rouge">meta_prefix</code> ì–´ë””ì—ì„œ ì™”ëŠ”ì§€ ëª…í™•íˆí•˜ê³  ì—´ ì´ë¦„ì´ ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ í•˜ë ¤ë©´ ë©”íƒ€ ì ‘ë‘ì‚¬ë¥¼ ì§€ì •</li>
    </ul>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">df = json_normalize(data['businesses'], sep="_", record_path = "categories", meta =["name", "alias", "rating",["coordinates","latitude"],["coordinates","longitude"]], meta_prefix = "biz_")</code></p>

<p><br /></p>

<h3 id="combining-multiple-datasets">Combining multiple datasets</h3>

<p>í”„ë¡œì íŠ¸ëŠ” ì—¬ëŸ¬ ìœ„ì¹˜ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>

<p><br /></p>

<h3 id="appending">Appending</h3>
<p><code class="language-plaintext highlighter-rouge">append()</code> ëŠ” ì¶”ê°€ í•  ë°ì´í„° í”„ë ˆì„ì„ ì¸ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° í”„ë ˆì„ ë©”ì„œë“œ</p>

<p>ex) <code class="language-plaintext highlighter-rouge">df1.append(df2)</code></p>

<p>indexë¥¼ ë¬´ì‹œí•˜ë ¤ë©´, <code class="language-plaintext highlighter-rouge">ingnore_index = True</code> ì„¤ì •</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">"term"</span> <span class="p">:</span> <span class="s">"bookstore"</span><span class="p">,</span> <span class="s">"location"</span> <span class="p">:</span> <span class="s">"San Francisco"</span><span class="p">}</span>
<span class="n">first_results</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">api_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">).</span><span class="n">json</span><span class="p">()</span>
<span class="n">first_20_bookstores</span> <span class="o">=</span> <span class="n">json_normalize</span><span class="p">(</span><span class="n">first_results</span><span class="p">[</span><span class="s">"businesses"</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s">"_"</span><span class="p">)</span>
<span class="n">bookstores</span> <span class="o">=</span> <span class="n">first_20_bookstores</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_20_bookstores</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="merging">Merging</h3>

<p>SQL joinê³¼ ë¹„ìŠ·í•˜ê²Œ ì‹¤í–‰ë¨</p>

<p>pandas ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">merge()</code>ë¥¼ ì´ìš©í•´ì„œ ë³‘í•©</p>

<p><br /></p>

<h3 id="dfmerge"><code class="language-plaintext highlighter-rouge">df.merge()</code></h3>

<ul>
  <li>ë‘ë²ˆì§¸ DataFrameê³¼ ë³‘í•©</li>
  <li>ë‘ DataFrame ì˜ columnì´ ì¼ì¹˜í•˜ëŠ” ê²½ìš° <code class="language-plaintext highlighter-rouge">on</code>íŒŒë¼ë¯¸í„°ë¥¼ ì´ìš©í•˜ì—¬, ë³‘í•© ê°€ëŠ¥</li>
  <li>ì„œë¡œ ë‹¤ë¥¼ê²½ìš°, <code class="language-plaintext highlighter-rouge">left_on</code> and <code class="language-plaintext highlighter-rouge">right_on</code> ì„ ì‚¬ìš©í•˜ì—¬ ë³‘í•©</li>
  <li>ë™ì¼í•œ ë°ì´í„° ìœ í˜•ì´ì—¬ì•¼í•¨</li>
  <li>ê¸°ë³¸ì ìœ¼ë¡œ mergeëŠ” ë‘ ë°ì´í„° ì„¸íŠ¸ì— ìˆëŠ” í‚¤ ê°’ì´ ìˆëŠ” í–‰ë§Œ ë°˜í™˜</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">merged = call_counts.merge(weather, left_on = "created_date", right_on="date")</code></p>

:ET