I"˜<h1 id="unit-testing-for-data-science-in-python">Unit Testing for Data Science in Python</h1>

<h2 id="unit-testing-basics">Unit testing basics</h2>

<p>í…ŒìŠ¤íŠ¸ í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë¨¼ì € ì¸í„°í”„ë¦¬í„°ê°€ ìˆì§€ë§Œ, ì´ëŠ” ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤.</p>

<p align="center"><img src="/images/post_img/unitest1.PNG" /></p>
<p align="center" style="font-size:100%; ">DataCamp-Unit Testing for Data Science in Python</p>

<p>ì´ëŸ¬í•œ ìƒì˜ ì£¼ê¸°ê°€ 100ë²ˆë„˜ê²Œ ë°˜ë³µë˜ê³  ìˆìŠµë‹ˆë‹¤.</p>

<pre><code class="language-txt">area (sq. ft.)	price (dollars)
2,081	314,942
1,059	186,606
	293,410
1,148	206,186
1,463238,765
</code></pre>

<p>ë‹¤ìŒê³¼ ê°™ì´ area ì´í›„ íƒ­ priceë¥¼ ê°€ì§„ êµ¬ì¡°ì—ì„œ, ë§Œì•½ ì˜¤ë¥˜ë¡œ ì¸í•´ areaê°€ ìƒëµë˜ê±°ë‚˜ íƒ­ì´ ëˆ„ë½ëœ ê²½ìš°</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">row_to_list</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="p">...</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Return value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>â€œ2,081\t314,942\nâ€</td>
      <td>Valid</td>
      <td>[â€œ2,081â€,â€314,952â€]</td>
    </tr>
    <tr>
      <td>â€œ\t293,410\nâ€</td>
      <td>Invalid</td>
      <td>None</td>
    </tr>
    <tr>
      <td>â€œ1,463238,765\nâ€</td>
      <td>Invaliid</td>
      <td>None</td>
    </tr>
  </tbody>
</table>

<p>ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš° Noneì„ ë°˜í™˜í•´ì•¼í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">row_to_list</span><span class="p">(</span><span class="s">"2,081</span><span class="se">\t</span><span class="s">314,942</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="p">[</span><span class="s">"2,081"</span><span class="p">,</span> <span class="s">"314,942"</span><span class="p">]</span>

<span class="n">row_to_list</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">293,410</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="bp">None</span>

<span class="n">row_to_list</span><span class="p">(</span><span class="s">"1,463238,765</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="bp">None</span>
</code></pre></div></div>

<p>ë‹¤ìŒì´ ì˜ ì‘ë™í•˜ëŠ”ì§€ ì§ì ‘ ì‹¤í—˜ì„ í•´ì•¼í•˜ëŠ” ê³¼ì •ì„ ê°€ì§‘ë‹ˆë‹¤. (ì´ëŸ¬í•œ ë°©ë²•ì€ ë„ˆë¬´ ë§ì€ ì‹œê°„ì„ ì†Œìš”)</p>

<p>ì´ëŸ¬í•œ ì‹œê°„ì„ ì¤„ì´ê¸° ìœ„í•´ì„œ ìœ ë‹›í…ŒìŠ¤íŒ…ì€ ë°ì´í„°ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸ì—ê²Œ í•„ìˆ˜ ê¸°ìˆ ì…ë‹ˆë‹¤.</p>

<h4 id="python-unit-testing-libraries">Python unit testing libraries</h4>

<ul>
  <li>pytest</li>
  <li>unittest</li>
  <li>nosetest</li>
  <li>doctest</li>
</ul>

<h4 id="pytest">pytest</h4>

<ul>
  <li>ì‚¬ìš©í•˜ê¸° ì‰½ë‹¤</li>
  <li>ê°€ì¥ ì¸ê¸°ìˆëŠ” í…ŒìŠ¤íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
  <li>ëª¨ë“  ë³¸ì§ˆì ì¸ í”¼ì²˜ë¥¼ ê°€ì§„ë‹¤.?</li>
</ul>

<h4 id="step-1-create-a-file">Step 1. Create a file</h4>

<p><code class="language-plaintext highlighter-rouge">test_row_to_list.py</code> ë¼ëŠ” íŒŒì¼ì„ ë§Œë“ ë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">test_</code> ë¡œ ì‹œì‘í•˜ëŠ” íŒŒì¼ ì´ë¦„ì„ ë°œê²¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì´í•´í•˜ë©´ë©ë‹ˆë‹¤.</p>

<p>-&gt; ì´ê²ƒì€ ì¼ë°˜ì ì¸ íŒŒì´ì¬ íŒŒì¼ì´ ì•„ë‹ˆë¼, ìœ ë‹›í…ŒìŠ¤íŠ¸ë¥¼ í¬í•¨í•˜ëŠ” íŠ¹ë³„í•œ íŒŒì¼ì…ë‹ˆë‹¤.</p>

<p>ìœ ë‹›í…ŒìŠ¤íŠ¸ë¥¼ í¬í•¨í•˜ëŠ” íŒŒì¼ì„ í…ŒìŠ¤íŠ¸ ëª¨ë“ˆì´ë¼ê³  í•©ë‹ˆë‹¤.</p>

<h4 id="step2-imports">Step2. Imports</h4>

<p><code class="language-plaintext highlighter-rouge">test_row_to_list.py</code></p>

<h4 id="step3-unit-tests-are-python-functions">Step3. Unit tests are Python functions</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">row_to_list</span>

<span class="k">def</span> <span class="nf">test_for_clean_row</span><span class="p">():</span>
</code></pre></div></div>

<p>ìœ ë‹ˆí…ŒìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ ëª¨ë“ˆì²˜ëŸ¼ ì´ë¦„ì´ <code class="language-plaintext highlighter-rouge">test_</code> ë¡œ ì‹œì‘í•˜ëŠ” python í•¨ìˆ˜ë¡œ ì‘ì„±ë©ë‹ˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Return value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>â€œ2,081\t314,942\nâ€</td>
      <td>Valid</td>
      <td>[â€œ2,081â€,â€314,942â€]</td>
    </tr>
  </tbody>
</table>

<h4 id="step4-assertsion">Step4. Assertsion</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="n">boolearn_expression</span>

<span class="k">assert</span> <span class="bp">True</span>
<span class="p">[</span><span class="n">output</span><span class="p">]</span>

<span class="k">assert</span> <span class="bp">False</span>
<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
    <span class="n">File</span> <span class="s">"&lt;stdin&gt;"</span><span class="p">,</span> <span class="n">Line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="nb">AssertionError</span>
</code></pre></div></div>

<p>assert ë¬¸ì—ëŠ” ëª¨ë“  ë¶€ìš¸ í‘œí˜„ì‹ì´ ë  ìˆ˜ ìˆëŠ” í•„ìˆ˜ ì²«ë²ˆì§¸ ì¸ìˆ˜ê°€ ì‡ìŠµë‹ˆë‹¤.</p>

<p>assert ë¬¸ì´ Trueì¼ ê²½ìš° í†µê³¼ë˜ì–´ ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">row_to_list</span>

<span class="k">def</span> <span class="nf">test_for_clean_row</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"2,081</span><span class="se">\t</span><span class="s">314,942</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s">"2,081"</span><span class="p">,</span> <span class="s">"314,942"</span><span class="p">]</span>
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì€ ê²½ìš°, í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ ê°’ì´, ë‹¤ìŒê³¼ ê°™ì€ ê°’ì„ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸ ( True ê°€ ë°˜í™˜ë˜ì–´ í†µê³¼ )</p>

<p>ë§Œì•½ Falseê°€ ìˆì„ê²½ìš°,  ì¦‰ í•¨ìˆ˜ì— ë²„ê·¸ê°€ ìˆìœ¼ë©´ assert ë¬¸ì€ AssertionErrorë¥¼ ë°œìƒì‹œí‚¤ê³  í…ŒìŠ¤íŠ¸ëŠ” ì‹¤íŒ¨</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">row_to_list</span>

<span class="k">def</span> <span class="nf">test_for_clean_row</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"2,081</span><span class="se">\t</span><span class="s">314,942</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s">"2,081"</span><span class="p">,</span> <span class="s">"314,942"</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">test_for_missing_area</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">293,410</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
    
<span class="k">def</span> <span class="nf">test_for_missing_tab</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"1,463238,765</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Return value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>â€œ2,081\t314,942\nâ€</td>
      <td>Valid</td>
      <td>[â€œ2,081â€,â€314,942â€]</td>
    </tr>
    <tr>
      <td>â€œ\t293,410\nâ€</td>
      <td>Invalid</td>
      <td>None</td>
    </tr>
    <tr>
      <td>â€œ1,463238,765\nâ€</td>
      <td>Invalid</td>
      <td>None</td>
    </tr>
  </tbody>
</table>

<p>ë³€ìˆ˜ê°’ì´ Noneì¸ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="n">var</span> <span class="ow">is</span> <span class="bp">None</span> <span class="c1"># O
</span>
<span class="k">assert</span> <span class="n">var</span> <span class="o">==</span> <span class="bp">None</span> <span class="c1"># X
</span></code></pre></div></div>

<p>== ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ is ë¥¼ ì‚¬ìš©í•¨ì„ ì£¼ëª©</p>

<h4 id="step5-running-unit-tests">Step5. Running unit tests</h4>

<p><code class="language-plaintext highlighter-rouge">pytest test_row_to_list.py</code></p>

<h4 id="unit-tests-for-row_to_list">Unit tests for row_to_list()</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">row_to_list</span>

<span class="k">def</span> <span class="nf">test_for_clean_row</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"2,081</span><span class="se">\t</span><span class="s">314,942</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s">"2,081"</span><span class="p">,</span> <span class="s">"314,942"</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">test_for_missing_area</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">293,410</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
    
<span class="k">def</span> <span class="nf">test_for_missing_tab</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"1,463238,765</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
</code></pre></div></div>

<p>ì½”ë“œë¥¼ ë³´ë©´, <code class="language-plaintext highlighter-rouge">import row_to_int</code> ê°€ ì„ ì–¸ë˜ì–´ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>í–‰ ì˜ì—­ ë°ì´í„°ê°€ ëˆ„ë½ ëœ í–‰  ë° íƒ­ êµ¬ë¶„ ê¸°í˜¸ê°€ ëˆ„ë½ ëœ í–‰ì„ ê°ê° ì •ë¦¬í•©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">!pytest test_row_to_list.py</code>ë¥¼ ì…ë ¥í•˜ë©´, ë§ì€ ì •ë³´ê°€ ìŸì•„ì ¸ ë‚˜ì˜µë‹ˆë‹¤.</p>

<h4 id="section-1-general-information">Section 1: general information</h4>

<p align="center"><img src="/images/post_img/unittest2.PNG" /></p>

<p>ìš´ì˜ ì²´ì œ, Python ë²„ì „, pytestíŒ¨í‚¤ì§€ ë²„ì „, ì‘ì—… ë””ë ‰í† ë¦¬ ë° pytest í”Œë¡œê·¸ì¸ ì •ë³´ê°€ ì¶œë ¥</p>

<h4 id="section-2-test-result">Section 2: Test result</h4>

<p align="center"><img src="/images/post_img/unittest3.PNG" /></p>

<p>ì¶œë ¥ì— â€œcollected 3 itemsâ€ ê°€ í‘œì‹œë˜ë©°, ì´ëŠ” pytestê°€ ì‹¤í–‰í•  í…ŒìŠ¤íŠ¸ 3ê°œë¥¼ ì°¾ì•˜ìŒì„ ì˜ë¯¸</p>

<p>ê·¸ ì•„ë« ì¤„ì—ëŠ”, test_row_to_list ì¸ í…ŒìŠ¤íŠ¸ ëª¨ë“ˆ ì´ë¦„ì´ í¬í•¨ë˜ì–´ìˆìŠµë‹ˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th>Character</th>
      <th>Meaning</th>
      <th>When</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>F</td>
      <td>Failure</td>
      <td>An exception is raised when running unit test</td>
      <td>Fix the function or unit test.</td>
    </tr>
    <tr>
      <td>.</td>
      <td>Passed</td>
      <td>No exception raised when running unit test</td>
      <td>Everything is fine. Be happy!</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_for_missing_area</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">293,410"</span><span class="p">)</span> <span class="ow">is</span> <span class="n">none</span> <span class="c1"># AssertionError from this line
</span></code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¬ë•Œ ê°€ì¥ ìì£¼ ë°œìƒí•©ë‹ˆë‹¤.</p>

<p>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>

<p>(ìœ„ì˜ ì˜ˆì‹œì—ì„œëŠ” None ì„ none ì´ë¼ê³  í‘œê¸°í•´ì„œ ì—ëŸ¬ê°€ ë°œìƒ)</p>

<p><code class="language-plaintext highlighter-rouge">.</code> ëŠ” assert ë¬¸ì´ë‚˜ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ ë‹¤ë¥¸ ë¶€ë¶„ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•Šì•˜ìŒì„ ì˜ë¯¸</p>

<p>ìœ„ì˜ ê²½ìš° <code class="language-plaintext highlighter-rouge">.F.</code> ì„ì„ í†µí•´ ì²«ë²ˆì§¸ì™€ ì„¸ë²ˆì§¸ëŠ” í†µê³¼í•˜ì˜€ì§€ë§Œ, 2ë²ˆì§¸ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h4 id="section-3-information-on-failed-tests">Section 3: Information on failed tests</h4>

<p align="center"><img src="/images/post_img/unittest4.PNG" /></p>

<p>ë‹¤ìŒ ì„¹ì…˜ì—ì„œëŠ” ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ì¤„ì€ <code class="language-plaintext highlighter-rouge">&gt;</code>ë¥¼ í†µí•´ í‘œê¸°ë©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">E</code>ë¡œ í‘œì‹œëœ ë‹¤ìŒ ì¤„ì—ëŠ” ì˜ˆì™¸ì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">where</code>ëŠ” assertë¬¸ì„ ì‹¤í–‰í•  ë•Œ ê³„ì‚° ëœ ëª¨ë“  ë°˜í™˜ ê°’ì„ í‘œì‹œí•©ë‹ˆë‹¤.</p>

<h4 id="section-4--test-result-summary">Section 4 : Test result summary</h4>

<p align="center"><img src="/images/post_img/unittest5.PNG" /></p>

<p>ë§ˆì§€ë§‰ ì¤„ì€, ê²°ê³¼ë¥¼ ìš”ì•½í•˜ì—¬ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>

<h4 id="unit-tests-ì¥ì ">Unit tests ì¥ì </h4>

<ul>
  <li>
    <p>ìœ ë‹›í…ŒìŠ¤íŠ¸ëŠ”, ì‹œê°„ ì ˆì•½ì„ ì‹œì¼œì¤ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>ìœ ë‹›í…ŒìŠ¤íŠ¸ëŠ” ì´ì²˜ëŸ¼, í•¨ìˆ˜ê°€ í•˜ëŠ” ì¼ì— ëŒ€í•œ ì¢‹ì€ íŒíŠ¸ë¥¼ ì œê³µí•˜ì—¬ í•¨ìˆ˜ì˜ ì½”ë“œë¥¼ ë” ë¹¨ë¦¬ ì´í•´í•˜ëŠ”ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>ë˜í•œ, ì´ëŠ” ì‹¤ì œ ìƒí™©ì„ ëª¨ë°©í•˜ê¸° ìœ„í•´ ì¼ë¶€ ì—°ìŠµì—ì„œëŠ” í…ŒìŠ¤íŠ¸ ëª¨ë“ˆì„ë³´ê³  í•¨ìˆ˜ì˜ ì‘ì—…ì„ ì¶”ì¸¡í•˜ë„ë¡ ìš”ì²­í•  ìˆ˜ ë„ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>ìœ ë‹›í…ŒìŠ¤íŠ¸ëŠ” ì‚¬ìš©ìê°€ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³  ê¸°ëŠ¥ì´ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, íŒ¨í‚¤ì§€ì— ëŒ€í•œ ì‹ ë¢°ë„ë¥¼ ë†’ì…ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>ìœ ë‹›í…ŒìŠ¤íŠ¸ëŠ” ìƒì‚°ì ì¸ ì‹œìŠ¤í…œì˜ downtimeì„ ì¤„ì¼ìˆ˜ ìˆìŠµë‹ˆë‹¤. (CIë¥¼ í†µí•´ ìœ ë‹›í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³  ìœ ë‹›í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•˜ë©´, ë³€ê²½ì„ ê±°ë¶€í•˜ì—¬ ë‹¤ìš´ íƒ€ì„ì„ ë°©ì§€)</p>
  </li>
</ul>

<h4 id="unitì´ë€-ë¬´ì—‡ì¼ê¹Œ">Unitì´ë€ ë¬´ì—‡ì¼ê¹Œ?</h4>

<ul>
  <li>ì‘ì€ ë…ë¦½ì ì¸ ì½”ë“œ</li>
  <li>Python í•¨ìˆ˜ ë˜ëŠ” í´ë˜ìŠ¤</li>
</ul>

<h2 id="mastering-assert-statements">Mastering assert statements</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="n">boolean_expression</span><span class="p">,</span> <span class="n">message</span>

<span class="k">assert</span> <span class="mi">1</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span> <span class="s">"One is not equal to two!"</span>

<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
    <span class="n">File</span> <span class="s">"&lt;stdin&gt;"</span><span class="p">,</span> <span class="n">line1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="nb">AssertionError</span><span class="p">:</span> <span class="n">One</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">two</span><span class="err">!</span>
</code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì´ , message ë‚´ìš©ì„ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ë„ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>

<span class="k">def</span> <span class="nf">test_for_missing_area_with_message</span><span class="p">():</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">row_to_list</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">293,410</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="s">"row_to_list('</span><span class="se">\t</span><span class="s">293,410</span><span class="se">\n</span><span class="s">') "</span>
              <span class="s">"returned {0} instead"</span> 
              <span class="s">"of {1}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
              <span class="p">)</span>
    <span class="k">assert</span> <span class="n">actual</span> <span class="ow">is</span> <span class="n">expected</span><span class="p">,</span> <span class="n">message</span>
</code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>

<p align="center"><img src="/images/post_img/unittest6.PNG" /></p>

<p>ì´ë ‡ê²Œ ì‚¬ìš©í•  ì‹œ, í•˜ë‹¨ì—ëŠ” ë©”ì‹œì§€ì™€ í•¨ê»˜ ìˆ˜ì • ëœ ê²ƒì„ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>

<p>(ì´ë ‡ê²Œí•˜ë©´, ìë™ì¶œë ¥ë³´ë‹¤, ì˜¤ë¥˜ë©”ì„¸ì§€ë¥¼ ì´í•´í•˜ëŠ”ë° í›¨ì”¬ ìˆ˜ì›”í•˜ë‹¤. )</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span> <span class="o">==</span><span class="mf">0.3</span>
<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="bp">False</span>

<span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span>
<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="mf">0.3000000000004</span>
</code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì´ íŒŒì´ì¬ ì½”ë“œëŠ” ì›í•˜ëŠ”ëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì„ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. (íŒŒì´ì¬ì˜ ë¶€ë™ ë°©ì‹ ë•Œë§¤)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span> <span class="o">==</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s">"Usual way to compare does not always work with floats!"</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span> <span class="o">==</span> <span class="n">pytest</span><span class="p">.</span><span class="n">approx</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">pytest.approx()</code> ëŠ” ì˜¤ë¥¸ìª½ ëì— ìˆëŠ” ìˆ«ìê°€ ë¬´ì‹œë˜ê³ , ë¶€ë™ ì†Œìˆ˜ì ì„ ì•ˆì „í•˜ê²Œ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span> <span class="o">==</span> <span class="n">pytest</span><span class="p">.</span><span class="n">approx</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">]))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>

<span class="k">def</span> <span class="nf">test_on_string_with_one_comma</span><span class="p">():</span>
    <span class="n">return_value</span> <span class="o">=</span> <span class="n">convert_to_int</span><span class="p">(</span><span class="s">"2,081"</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">return_value</span> <span class="o">==</span> <span class="mi">2081</span>
</code></pre></div></div>

<p>í•¨ìˆ˜ê°€ ì •ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•˜ëŠ” ì½”ë“œë¥¼ ì˜ˆë¥¼ ë“¤ì–´ë³´ë©´,  instance() í•¨ìˆ˜ë¥¼ ì´ìš©í•©ë‹ˆë‹¤. ì¸ìˆ˜ ë‘ë²ˆì¨°ë¡œëŠ”, ì˜ˆìƒ ìœ í˜•(int)ë¥¼ ì…ë ¥,</p>

<p>ë°˜í™˜ ê°’ì´, ì˜ˆìƒ ê°’ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ëŠ”, ë˜ ë‹¤ë¥¸ assert ë¬¸ìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜í–‰</p>

<h4 id="testing-for-exceptions-instead-of-return-values">Testing for exceptions instead of return values</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">example_argument</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2081</span><span class="p">,</span> <span class="mi">314942</span><span class="p">],</span>
                           	<span class="p">[</span><span class="mi">1059</span><span class="p">,</span> <span class="mi">186606</span><span class="p">],</span>
                           	<span class="p">[</span><span class="mi">1148</span><span class="p">,</span> <span class="mi">206186</span><span class="p">],</span>
                            <span class="p">]</span>
                           <span class="p">)</span>
<span class="n">split_into_training_and_testing_sets</span><span class="p">(</span><span class="n">example_argument</span><span class="p">)</span>

<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="p">(</span><span class="n">array</span><span class="p">([[</span><span class="mi">1148</span><span class="p">,</span> <span class="mi">206186</span><span class="p">],</span>
      	<span class="p">[</span><span class="mi">2081</span><span class="p">,</span> <span class="mi">314942</span><span class="p">],</span>
       <span class="p">]</span>
      <span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1059</span><span class="p">,</span> <span class="mi">186606</span><span class="p">]])</span>
<span class="p">)</span>
</code></pre></div></div>

<p>ë‹¤ìŒ í•¨ìˆ˜ëŠ” 2ì°¨ì› ë°°ì—´ì„ 75%ë¥¼ trainì— 25%ë¥¼ testì— ì „ë‹¬í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">example_argument</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2081</span><span class="p">,</span> <span class="mi">314942</span><span class="p">,</span> <span class="mi">1059</span><span class="p">,</span> <span class="mi">186606</span><span class="p">,</span> <span class="mi">1148</span><span class="p">,</span> <span class="mi">206186</span><span class="p">])</span>
<span class="n">split_into_training_and_testing_sets</span><span class="p">(</span><span class="n">example_argument</span><span class="p">)</span>
</code></pre></div></div>

<p>1ì°¨ì› ë°°ì—´ì„ ì „ë‹¬í•˜ê²Œ ë˜ë©´, ValueErrorê°€ ë°œìƒë©ë‹ˆë‹¤. ì´ë¥¼ ì´ì œ ì˜¤ë¥˜ ë©”ì„¸ì§€ì™€ í•¨ê»˜ í‘œì‹œí•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_valueerror_on_one_dimensional_argument</span><span class="p">():</span>
    <span class="n">example_argument</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2081</span><span class="p">,</span> <span class="mi">314942</span><span class="p">,</span> <span class="mi">1059</span><span class="p">,</span> <span class="mi">186606</span><span class="p">,</span> <span class="mi">1148</span><span class="p">,</span> <span class="mi">206186</span><span class="p">])</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="p">.</span><span class="n">raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">):</span>
        <span class="n">split_into_training_and_testing_sets</span><span class="p">(</span><span class="n">example_argument</span><span class="p">)</span>
</code></pre></div></div>

<p>í•¨ìˆ˜ê°€ ì˜ˆìƒëŒ€ë¡œ ValueErrorë¥¼ ë°œìƒ ì‹œí‚¤ë©´ ì¹¨ë¬µì´ë˜ê³ , í…ŒìŠ¤íŠ¸ê°€ í†µê³¼ë©ë‹ˆë‹¤.</p>

<p>ValueErrorê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´, ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬ìê°€ ì‹¤íŒ¨ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œì¼œ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_valueerror_on_one_dimensional_argument</span><span class="p">():</span>
    <span class="n">example_argument</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2081</span><span class="p">,</span> <span class="mi">314942</span><span class="p">,</span> <span class="mi">1059</span><span class="p">,</span> <span class="mi">186606</span><span class="p">,</span> <span class="mi">1148</span><span class="p">,</span> <span class="mi">206186</span><span class="p">])</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="p">.</span><span class="n">raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exception_info</span><span class="p">:</span>
        <span class="n">split_into_training_and_testing_sets</span><span class="p">(</span><span class="n">example_argument</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">exception_info</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="s">"Argument data array must be two dimentional."</span>
                               <span class="s">"Got 1 dimensional array instead!"</span>
                               <span class="p">)</span>
</code></pre></div></div>

<p>as ì ˆì„ ì‚¬ìš©í•˜ì—¬ withë¬¸ì„ í™•ì¥í•˜ë©´ ì»¨í…ìŠ¤íŠ¸ë‚´ì—ì„œ valueErrorê°€ ë°œìƒí•˜ë©´, exception_infoì—ëŠ” ì¹¨ë¬µ ëœ ValueErrorì— ëŒ€í•œ ì •ë³´ê°€ í¬í•¨ë©ë‹ˆë‹¤.</p>

<h4 id="the-well-tested-function">The well tested function</h4>

<p>ì´ì „ì— split_into_training_and_testing_sets ë¥¼ ìƒê°í•˜ë©´</p>

<table>
  <thead>
    <tr>
      <th>Number of rows (argument)</th>
      <th>Number of rows (training array)</th>
      <th>Number of rows (testing array)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>8</td>
      <td>int(0.75 * 8) = 6</td>
      <td>8 - int(0.75 * 8) = 2</td>
    </tr>
    <tr>
      <td>10</td>
      <td>int(0.75 * 10) = 7</td>
      <td>10 - int(0.75 * 10) = 3</td>
    </tr>
  </tbody>
</table>

<p>ë” ë§ì€ ì¼€ì´ìŠ¤ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ë¡, í•¨ìˆ˜ê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ê³  ìˆë‹¤ëŠ” í™•ì‹ ì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì‹œê°„ìƒì˜ ë¬¸ì œë¡œ ë” ë§ì€ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>

<h4 id="test-argument-types">Test argument types</h4>

<ul>
  <li>Bad arguments</li>
  <li>Special arguments</li>
  <li>Normal arguments</li>
</ul>

<p>ë‹¤ìŒê³¼ ê°™ì´, íƒ€ì…ì„ ë‚˜ëˆ ì„œ í…ŒìŠ¤íŠ¸í•˜ë©´ í•¨ìˆ˜ë¥¼ ë” ì˜ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h4 id="type-1-bad-argumentsone-dimensional-array">Type 1: Bad arguments(one dimensional array)</h4>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Num rows(training)</th>
      <th>Num rows (testing)</th>
      <th>exceptions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>One dimensional</td>
      <td>Bad</td>
      <td>-</td>
      <td>-</td>
      <td>ValueError</td>
    </tr>
  </tbody>
</table>

<p>Example: <code class="language-plaintext highlighter-rouge">np.array([845.0, 31036.0, 1291.0, 72205.0])</code></p>

<p>ë‹¤ìŒê³¼ ê°™ì´ ì˜ëª»ëœ ì¸ì íƒ€ì…ì´ ë“¤ì–´ì™”ì„ ë•, ValueErrorë¥¼ ì¶œë ¥í•  ê²ƒì…ë‹ˆë‹¤.</p>

<h4 id="type-2-special-arguments">Type 2: Special arguments</h4>

<ul>
  <li>Boundary values.</li>
  <li>For some argument values, function uses special logic</li>
</ul>

<h4 id="type-3-normal-arguments">Type 3: Normal arguments</h4>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ, ë‚˜ì˜ì§€ë„ íŠ¹ë³„í•˜ì§€ë„ ì•ŠëŠ” ì •ìƒê°’ì„ í…ŒìŠ¤íŠ¸</p>

<h4 id="test-driven-development-tdd">Test Driven Development (TDD)</h4>

<p>ìœ ë‹›í…ŒìŠ¤íŠ¸ê°€ ì¤‘ìš”í•˜ì§€ë§Œ, í˜„ì‹¤ì—ì„œëŠ”, ì‘ì„±ì„ ê±´ë„ˆ ë›°ëŠ” ê²ƒì´ ë„ˆë¬´ ì¼ë°˜ì ì…ë‹ˆë‹¤.</p>

<ol>
  <li>Feature development.</li>
  <li>Unit testing</li>
</ol>

<p>ìœ ë‹›í…ŒìŠ¤íŠ¸ì˜ ìš°ì„ ìˆœìœ„ê°€ ë‹¤ë¥¸ê²ƒë³´ë‹¤ ë’¤ì³ì§€ê¸° ë•Œë¬¸ì—, ë¯¸ë£¨ë‹¤ê°€ ê²°êµ­ ì‘ì„±í•˜ì§€ ì•Šê²Œë©ë‹ˆë‹¤.</p>

<p>ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œëŠ”, í•¨ìˆ˜ê°€ ì½”ë“œë¡œ êµ¬í˜„ë˜ê¸° ì „ì—ë„ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>

<h4 id="step-1-write-unit-tests-and-fix-requirements">Step 1. Write unit tests and fix requirements</h4>

<h4 id="step-2-run-tests-and-watch-it-fail">Step 2. Run tests and watch it fail</h4>

<h4 id="step-3-implement-function-and-run-tests-again">Step 3. Implement function and run tests again</h4>

<h2 id="how-to-organize-a-growing-set-of-tests">How to organize a growing set of tests?</h2>

<p align="center"><img src="/images/post_img/unittest7.PNG" /></p>

<p>í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•´ì„œ í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì </p>

<h4 id="test-class--theoretical-structure">Test class : theoretical structure</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">data.preprocessing_helpers</span> <span class="kn">import</span> <span class="n">row_to_list</span><span class="p">,</span> <span class="n">convert_to_list</span>

<span class="k">class</span> <span class="nc">TestRowToList</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_on_no_tab_no_missing_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">...</span>
    <span class="k">def</span> <span class="nf">test_on_two_tabs_no_missing_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">...</span>
        
<span class="k">class</span> <span class="nc">TestConvertToInt</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_with_no_comma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">...</span>
    <span class="k">def</span> <span class="nf">test_with_one_comma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">...</span>
</code></pre></div></div>

<p>í•¨ìˆ˜í˜•ìœ¼ë¡œ í•˜ëŠ” ë°©ë²•ë³´ë‹¤ classí˜•ìœ¼ë¡œ í•˜ëŠ” ê²ƒì´ ë” íš¨ìœ¨ì ì„.</p>

<h4 id="mastering-test-execution">Mastering test execution</h4>

<p>ì´ì „ì— í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë¥¼ ì„ ì–¸í–ˆì—ˆëŠ”ë°, í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ëŠ” íŠ¹ì • í•¨ìˆ˜ì— ëŒ€í•œ ìœ ë‹› í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì»¨í…Œì´ë„ˆì¼ ë¿ì…ë‹ˆë‹¤.</p>

<p>pytestëŠ” í…ŒìŠ¤íŠ¸ í´ë”ì— í¬í•¨ ëœ ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ì‰¬ìš´ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd test
</span>pytest
</code></pre></div></div>

<p>ë‹¨ì§€ ì´ë ‡ê²Œ ì‹¤í–‰í•˜ë©´ë©ë‹ˆë‹¤.</p>

<p>ì´ ëª…ë ¹ì€ ì‘ì—… ë””ë ‰í† ë¦¬ì˜ í•˜ìœ„ íŠ¸ë¦¬ë¡œ ë°˜ë³µí•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ìë™ìœ¼ë¡œ ê²€ìƒ‰í•©ë‹ˆë‹¤.</p>

<ul>
  <li>
    <p>ì´ë¦„ì´ â€œtest_â€ ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  íŒŒì¼ì„ í…ŒìŠ¤íŠ¸ ëª¨ë“ˆë¡œ ì‹ë³„í•©ë‹ˆë‹¤.</p>
  </li>
  <li>í…ŒìŠ¤íŠ¸ ëª¨ë“ˆ ë‚´ì—ì„œ ì´ë¦„ì´ â€œTestâ€ ë¡œ ì‹œì‘í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë¡œ ì‹ë³„í•©ë‹ˆë‹¤.</li>
  <li>ê° í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ë‚´ì—ì„œ â€œtest_â€œë¡œ ì‹œì‘í•˜ëŠ” ì´ë¦„ì„ ê°€ì§„ ëª¨ë“  í•¨ìˆ˜ë¥¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¡œ ì‹ë³„í•©ë‹ˆë‹¤.</li>
</ul>

<p align="center"><img src="/images/post_img/unittest8.PNG" /></p>

<p>ë‹¤ìŒê³¼ ê°™ì´, ì‹¤í–‰í•˜ë©´, ìœ ë‹›í…ŒìŠ¤íŠ¸ ì‹¤í–‰ê²°ê³¼ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">pytest -x</code> ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ ì‹¤íŒ¨í›„ pytestë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤.</p>

<p>ë§Œì•½ íŠ¹ì • pytestë§Œ ì‹¤í–‰í•˜ê³ ì‹¶ìœ¼ë©´, í•´ë‹¹ ê²½ë¡œë¥¼ ì§€ì •í•´ì£¼ë©´ë©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">pytest data/test_preprocessing_helpers.py</code></p>

<h4 id="node-id">Node ID</h4>

<ul>
  <li>Node ID of a test class: <code class="language-plaintext highlighter-rouge">&lt;path to test module&gt;::&lt;test class name&gt;</code></li>
  <li>Node ID of a unit test: <code class="language-plaintext highlighter-rouge">&lt;path to test module&gt;::&lt;test class name&gt;::&lt;unit test name&gt;</code></li>
</ul>

<h4 id="running-tests-using-node-id">Running tests using node ID</h4>

<p><code class="language-plaintext highlighter-rouge">pytest data/test_preprocessing_helpers.py::TestRowToList</code></p>

<p>ì´ëŸ¬í•œ ë°©ë²•ì„ ë” ë¹ ë¥´ê³  ìœ ì—°í•˜ê²Œ í•˜ëŠ” ë°©ë²•ì€ í‚¤ì›Œë“œ í‘œí˜„ì‹ì…ë‹ˆë‹¤.</p>

<h4 id="the--k-option">The -k option</h4>

<ul>
  <li>Run the test class <code class="language-plaintext highlighter-rouge">TestSplitIntoTrainingAndTestingSets</code></li>
</ul>

<p><code class="language-plaintext highlighter-rouge">pytest -k "TestSplitIntoTrainingAndTestingSets"</code></p>

<p><code class="language-plaintext highlighter-rouge">pytest -k "TestSplit"</code></p>

<p><code class="language-plaintext highlighter-rouge">pytest -k "TestSplit and not test_on_one_row"</code></p>

<h4 id="expected-failures-and-conditional-skipping">Expected failures and conditional skipping</h4>

<p>ì‹¤íŒ¨ë¥¼ ì˜ˆìƒí•˜ëŠ” ìœ ë‹›í…ŒìŠ¤íŠ¸ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ìœ¼ë¡œëŠ” xfailì´ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>

<span class="k">class</span> <span class="nc">TestTrainModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="o">@</span><span class="n">pytest</span><span class="p">.</span><span class="n">mark</span><span class="p">.</span><span class="n">xfail</span>
    <span class="k">def</span> <span class="nf">test_on_linear_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">...</span> 
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">pytest</code> ë¥¼ ì‹¤í–‰í•˜ë©´, í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ê°€ xfailedì„ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p align="center"><img src="/images/post_img/unittest9.PNG" /></p>

<p>ì´ëŠ” ì˜ íŒŒì´ì¬ ë²„ì „, íŠ¹ì • í”Œë«í¼ì— ë”°ë¼ ì˜ ì‘ë™í•˜ì§€ ì•Šì„ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>

<span class="k">class</span> <span class="nc">TestConvertToInt</span><span class="p">(</span><span class="n">objcet</span><span class="p">):</span>
    <span class="o">@</span><span class="n">pytest</span><span class="p">.</span><span class="n">mark</span><span class="p">.</span><span class="n">skipif</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">version_info</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">reason</span><span class="o">=</span><span class="s">"requires Python 2.7"</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_with_no_comma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Only runs on Python 2.7 or lower"""</span>
        <span class="n">test_argument</span> <span class="o">=</span> <span class="s">"756"</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="mi">756</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">convert_to_int</span><span class="p">(</span><span class="n">test_argument</span><span class="p">)</span>
        <span class="n">message</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="s">"Expected: 2081, Actual: {0}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">actual</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="n">message</span>
</code></pre></div></div>

<ul>
  <li>
    <p>ë‹¤ìŒê³¼ ê°™ì´ ë…ìŠ¤íŠ¸ë§ì„ í†µí•´ í‘œì‹œí•˜ëŠ” ê²ƒì„ ê¶Œì¥</p>
  </li>
  <li>
    <p>skipif ë°ì½”ë ˆì´í„°ë¥¼ ì´ìš©í•´ì„œ íŒŒì´ì¬ ë²„ì „ì´ ë§ì§€ì•Šì€ ê²½ìš° íŒ¨ìŠ¤</p>
  </li>
</ul>

<p align="center"><img src="/images/post_img/unittest10.PNG" /></p>

<p><code class="language-plaintext highlighter-rouge">pytest -r</code> ì„ ì‚¬ìš©í•˜ë©´ reasonì„ ë³´ì—¬ì§€ê²Œ í•©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">pytest -r[set_of_characters]</code></p>

<p><code class="language-plaintext highlighter-rouge">pytest -rs</code> së¥¼ ì¶”ê°€í•˜ë©´ ë ë¶€ë¶„ì— ìˆëŠ” ì§§ì€ í…ŒìŠ¤íŠ¸ ìš”ì•½ ì„¹ì…˜ì—ì„œ ê±´ë„ˆ ë›´ í…ŒìŠ¤íŠ¸ê°€ í‘œì‹œ</p>

<p><code class="language-plaintext highlighter-rouge">pytest - rx</code> xë¥¼ ì¶”ê°€í•˜ë©´ í…ŒìŠ¤íŠ¸ ìš”ì•½ ì •ë³´ì˜ ì´ìœ ë¥¼ í‘œì‹œ</p>

<p><code class="language-plaintext highlighter-rouge">pytest -rsx</code> ë˜í•œ ê°€ëŠ¥</p>

<h4 id="continuous-integration-and-code-coverage">Continuous integration and code coverage</h4>

<p>ê¹ƒí—™ë“±ì— ë±ƒì§€ë¥¼ ë‹¤ëŠ” ë°©ë²•</p>

<h4 id="step-1-create-a-configuration-file">Step 1. Create a configuration file</h4>

<ul>
  <li>Contents of <code class="language-plaintext highlighter-rouge">.travis.yml</code></li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">language</span><span class="pi">:</span> <span class="s">python</span>
<span class="na">python</span><span class="pi">:</span>
<span class="err">	</span><span class="pi">-</span> <span class="s2">"</span><span class="s">3.6"</span>
<span class="na">install</span><span class="pi">:</span>
<span class="err">	</span><span class="pi">-</span> <span class="s">pip install -e.</span>
<span class="na">script</span><span class="pi">:</span>
<span class="err">	</span><span class="pi">-</span> <span class="s">pytest tests</span>
</code></pre></div></div>

<h4 id="step-2-push-the-file-to-github">Step 2. Push the file to Github</h4>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add .travis.yml
git push origin master
</code></pre></div></div>

<h4 id="step-3-install-the-travis-ci-app">Step 3. Install the Travis CI app</h4>

<ul>
  <li>ê¹ƒí—™ì—ì„œ Travis CIë¥¼ ê²€ìƒ‰í•˜ê³  í´ë¦­</li>
  <li>ì•±ì„ ì„¤ì¹˜</li>
  <li>í•„ìš”í•œ ì €ì¥ì†Œ ë˜ëŠ” ì¡°ì§ì— ëŒ€í•œ ì•± ì—‘ì„¸ìŠ¤ë¥¼ í—ˆìš©</li>
  <li>ê¹ƒí—™ ê³„ì •ì„ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ì¸í•´ì•¼í•˜ëŠ” Travis CIë¡œ ë¦¬ë””ë ‰ì…˜</li>
</ul>

<p>ì´ëŸ¬í•œ ê³¼ì •ì„ ê±¸ì¹˜ë©´ ê¹ƒí—™ README ì— ë±ƒì§€ê°€ ì¶”ê°€ë¨</p>

<p>â€”â€”â€“ Codecov ìƒëµ â€”â€”â€”â€”</p>

<h2 id="beyond-assertion-setup-and-teardown">Beyond assertion: setup and teardown</h2>

<p>assertë¬¸ ì´ìƒì´ í•„ìš”í•œ í•¨ìˆ˜ë¥¼ ì‚´í´ë´…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">raw_data_file_path</span><span class="p">,</span> <span class="n">clean_data_file_path</span><span class="p">):</span>
    <span class="p">...</span>
</code></pre></div></div>

<p>ë‹¤ìŒ í•¨ìˆ˜ëŠ” ë°ì´í„° íŒŒì¼ ë° ê¹¨ë—í•œ íŒŒì¼ì— ëŒ€í•œ ê²½ë¡œë¥¼ ì¸ìë¡œ ë°›ìŠµë‹ˆë‹¤.</p>

<pre><code class="language-txt">1,801	201,411
1,767565,112
2,002	333,209
1990	782,911
1,285	389129
</code></pre>

<p>ë‹¤ìŒê³¼ ê°™ì€ ë°ì´í„°ë¥¼ ì „ë‹¬í•´ì•¼ í•  ë•Œ, ë‘ë²ˆ ì§¸ í–‰ì—ëŠ” íƒ­êµ¬ë¶„ ê¸°í˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>

<p>ì´ë¥¼ row_to_list() ë¥¼ í†µí•´ì„œ ê±¸ëŸ¬ëƒ…ë‹ˆë‹¤. ì´í›„ convert_to_int() ê°€ ì ìš©ë©ë‹ˆë‹¤.</p>

<p>4, 5ë²ˆì§¸ í–‰ì„ ë³´ë©´, ê°ê° ì‰¼í‘œê°€ ì—†ê¸°ì—, ë”ëŸ½ë‹¤ê³  íŒë‹¨ë©ë‹ˆë‹¤. convert_to_int() ëŠ” ì´ë¥¼ í•„í„°ë§í•©ë‹ˆë‹¤.</p>

<pre><code class="language-txt">1801	201411
2002	333209
</code></pre>

<p>ë‘ê°œì˜ ìœ íš¨í•œ í–‰ì— ëŒ€í•´ convert_to_int()ëŠ” ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ë¬¸ìì—´ì„ ì •ìˆ˜ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>

<p>preprocess() ëŠ” ì œëŒ€ë¡œ ì‘ë™í•˜ê¸° ìœ„í•œ ì „ì œì¡°ê±´ì´ ìˆê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ í•¨ìˆ˜ë‘ì€ ë‹¤ë¦…ë‹ˆë‹¤.</p>

<ol>
  <li>environment ì— raw ë°ì´í„° íŒŒì¼ì´ ì¡´ì¬í•´ì•¼í•©ë‹ˆë‹¤.</li>
  <li>í•¨ìˆ˜ë¥¼ í˜¸ì¶œ í•  ë•Œ ê¹¨ë—í•œ ë°ì´í„° íŒŒì¼ì„ ë§Œë“¤ì–´ environmentë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.</li>
</ol>

<p>ì´ ê³¼ì •ì„ <code class="language-plaintext highlighter-rouge">test_on_raw_data()</code> ë¡œ ë§Œë“¤ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_on_raw_data</span><span class="p">():</span>
    <span class="c1"># Setup: create the raw data file
</span>    <span class="n">preprocess</span><span class="p">(</span><span class="n">raw_data_file_path</span><span class="p">,</span> <span class="n">clean_data_file_path</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">clean_data_file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">first_line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">first_line</span> <span class="o">=</span> <span class="s">"1801</span><span class="se">\t</span><span class="s">201411</span><span class="se">\n</span><span class="s">"</span>
    <span class="n">second_line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">second_line</span> <span class="o">==</span> <span class="s">"2002</span><span class="se">\t</span><span class="s">333209</span><span class="se">\n</span><span class="s">"</span>
    <span class="c1"># Teardown: remove raw and clean data file
</span></code></pre></div></div>

<h4 id="the-new-workflow">The new workflow</h4>

<p>Old workflow</p>

<ul>
  <li>assert</li>
</ul>

<p>New workflow</p>

<ul>
  <li>setup -&gt; assert -&gt; teardown</li>
</ul>

<h4 id="fixture">Fixture</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>

<span class="o">@</span><span class="n">pytest</span><span class="p">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">my_fixture</span><span class="p">():</span>
    <span class="c1"># Do setup here
</span>    <span class="k">yield</span> <span class="n">data</span> <span class="c1"># return ëŒ€ì‹  yield ì‚¬ìš©
</span>	<span class="c1"># Do teardown here
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_something</span><span class="p">(</span><span class="n">my_fixture</span><span class="p">):</span>
    <span class="p">...</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">my_fixture</span>
    <span class="p">...</span>
</code></pre></div></div>

<p align="center"><img src="/images/post_img/unittest11.PNG" /></p>

<p>Fixtureê³¼ testë¥¼ ë¹„êµí•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<h4 id="tmpdir-pytest-fixture"><code class="language-plaintext highlighter-rouge">tmpdir</code> pytest fixture</h4>

<p>ì´ê²ƒì€, ì„¤ì • ì¤‘ì— ì„ì‹œ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•˜ê³  ë¶„í•´ ì¤‘ì— ì„ì‹œ ë””ë ‰í† ë¦¬ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">pytest</span><span class="p">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">raw_and_clean_data_file</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">):</span>
    <span class="n">raw_data_file_path</span> <span class="o">=</span> <span class="n">tmpdir</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">"raw.txt"</span><span class="p">)</span>
    <span class="n">clean_data_file_path</span> <span class="o">=</span> <span class="n">tmpdir</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">"clean.txt"</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">raw_data_file_path</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"1,801</span><span class="se">\t</span><span class="s">201,411</span><span class="se">\n</span><span class="s">"</span>
               <span class="s">"1,767565,112</span><span class="se">\n</span><span class="s">"</span>
               <span class="s">"2,002</span><span class="se">\t</span><span class="s">333,209</span><span class="se">\n</span><span class="s">"</span>
               <span class="s">"1990</span><span class="se">\t</span><span class="s">782,911</span><span class="se">\n</span><span class="s">"</span>
               <span class="s">"1,285</span><span class="se">\t</span><span class="s">389129</span><span class="se">\n</span><span class="s">"</span>
               <span class="p">)</span>
    <span class="k">yield</span> <span class="n">raw_data_file_path</span><span class="p">,</span> <span class="n">clean_data_file_path</span>
</code></pre></div></div>

<h4 id="mocking">Mocking</h4>

<p>ì´ì „ì— ë²„ê·¸ê°€ ìˆìœ¼ë©´, preprocess()ì— ë²„ê·¸ê°€ ì—†ë”ë¼ë„ preprocess() ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ê°€ í†µê³¼ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>

<p>mockingì„ ìœ„í•´ì„œëŠ” ë‘ê°€ì§€ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">pytest-mock</code> : Install using <code class="language-plaintext highlighter-rouge">pip install pytest-mock</code></li>
  <li><code class="language-plaintext highlighter-rouge">unittest.mock</code> : Python standard library package</li>
</ul>

<p>Mocking ì˜ ê¸°ë³¸ ê°œë…ì€ ì ì¬ì ìœ¼ë¡œ ëŒ€ì²´í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ëª¨ì¡°í’ˆì„ ë§Œë“¤ì–´ ì˜¤ë¥˜ê°€ ë‚œ ê²ƒì„ ëŒ€ì²´í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_on_raw_data</span><span class="p">(</span><span class="n">raw_and_clean_data_file</span><span class="p">,</span> <span class="n">mocker</span><span class="p">):</span>
    <span class="n">raw_path</span><span class="p">,</span> <span class="n">clean_path</span> <span class="o">=</span> <span class="n">raw_and_clean_data_file</span>
    <span class="n">row_to_list_mock</span> <span class="o">=</span> <span class="n">mocker</span><span class="p">.</span><span class="n">patch</span><span class="p">(</span><span class="s">"data.preprocessing_helpers.row_to_list"</span><span class="p">,</span>
                                   <span class="n">row_to_list_mock</span><span class="p">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">row_to_list_bug_free</span><span class="p">)</span>
    <span class="n">preprocess</span><span class="p">(</span><span class="n">raw_path</span><span class="p">,</span> <span class="n">clean_path</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">row_to_list_mock</span><span class="p">.</span><span class="n">call_args_list</span> <span class="o">==</span> <span class="p">[</span>
        <span class="n">call</span><span class="p">(</span><span class="s">"1,801</span><span class="se">\t</span><span class="s">201,411</span><span class="se">\n</span><span class="s">"</span><span class="p">),</span>
        <span class="n">call</span><span class="p">(</span><span class="s">"1,767565,112</span><span class="se">\n</span><span class="s">"</span><span class="p">),</span>
        <span class="n">call</span><span class="p">(</span><span class="s">"2,002</span><span class="se">\t</span><span class="s">333,209</span><span class="se">\n</span><span class="s">"</span><span class="p">),</span>
        <span class="n">call</span><span class="p">(</span><span class="s">"1990</span><span class="se">\t</span><span class="s">782,911</span><span class="se">\n</span><span class="s">"</span><span class="p">),</span>
        <span class="n">call</span><span class="p">(</span><span class="s">"1,285</span><span class="se">\t</span><span class="s">389129</span><span class="se">\n</span><span class="s">"</span><span class="p">),</span>
    <span class="p">]</span>    
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">row_to_list_bug_free</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">return_values</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"1,801</span><span class="se">\t</span><span class="s">201,411</span><span class="se">\n</span><span class="s">"</span><span class="p">:</span> <span class="p">[</span><span class="s">"1,801"</span><span class="p">,</span> <span class="s">"201,411"</span><span class="p">],</span>
        <span class="s">"1,767565,112</span><span class="se">\n</span><span class="s">"</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
        <span class="s">"2,002</span><span class="se">\t</span><span class="s">333,209</span><span class="se">\n</span><span class="s">"</span> <span class="p">:</span> <span class="p">[</span><span class="s">"2,002"</span><span class="p">,</span> <span class="s">"333,209"</span><span class="p">],</span>
        <span class="s">"1990</span><span class="se">\t</span><span class="s">782,911</span><span class="se">\n</span><span class="s">"</span> <span class="p">:</span> <span class="p">[</span><span class="s">"1990"</span><span class="p">,</span> <span class="s">"782,911"</span><span class="p">],</span>
        <span class="s">"1,285</span><span class="se">\t</span><span class="s">389129</span><span class="se">\n</span><span class="s">"</span> <span class="p">:</span> <span class="p">[</span><span class="s">"1,285"</span><span class="p">,</span> <span class="s">"389129"</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">return_values</span><span class="p">[</span><span class="n">row</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="testing-models">Testing models</h4>

<p align="center"><img src="/images/post_img/unittest12.PNG" /></p>

<p>ë‹¤ìŒê³¼ ê°™ì´ íŒŒì¼ì„ ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">data.preprocessing_helpers</span> <span class="kn">import</span> <span class="n">preprocess</span>
<span class="kn">from</span> <span class="nn">features.as_numpy</span> <span class="kn">import</span> <span class="n">get_data_as_numpy_array</span>
<span class="kn">from</span> <span class="nn">models.train</span> <span class="kn">import</span> <span class="p">(</span><span class="n">split_into_training_and_testing_sets</span><span class="p">)</span>

<span class="n">preprocess</span><span class="p">(</span><span class="s">"data/raw/housing_data.txt"</span><span class="p">,</span>
          <span class="s">"data/clean/clean_housing_data.txt"</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">get_data_as_numpy_array</span><span class="p">(</span><span class="s">"data/clean/clean_housing_data.txt"</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">get_data_as_numpy_array</span><span class="p">(</span><span class="s">"data/clean/clean_housing_data.txt"</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">trainning_set</span><span class="p">,</span> <span class="n">testing_set</span> <span class="o">=</span> <span class="p">(</span><span class="n">split_into_training_and_testing_sets</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</code></pre></div></div>

<p>ë‹¤ìŒ ê³¼ì •ë“¤ì„ ê±¸ì¹œ ë°ì´í„°ê°€ ì˜ í•™ìŠµê¹Œì§€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>

<span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">training_set</span><span class="p">):</span>
	<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">training_set</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">training_set</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span>
</code></pre></div></div>

<h4 id="trick-1-use-dataset-where-return-value-is-known">Trick 1: Use dataset where return value is known</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">models.train</span> <span class="kn">import</span> <span class="n">train_model</span>
<span class="k">def</span> <span class="nf">test_on_linear_data</span><span class="p">():</span>
    <span class="n">test_argument</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
                              <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
                              <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]</span>
                             <span class="p">]</span>
                            <span class="p">)</span>
    <span class="n">expected_slope</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">expected_intercept</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">test_argument</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">slope</span> <span class="o">==</span> <span class="n">pytest</span><span class="p">.</span><span class="n">approx</span><span class="p">(</span><span class="n">expected_slope</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">intercept</span> <span class="o">==</span> <span class="n">pytest</span><span class="p">.</span><span class="n">approx</span><span class="p">(</span><span class="n">expected_intercept</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="trick-2-use-inequalities">Trick 2: Use inequalities</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">models.train</span> <span class="kn">import</span> <span class="n">train_model</span>
<span class="k">def</span> <span class="nf">test_on_positively_correlated_data</span><span class="p">():</span>
    <span class="n">test_argument</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
                              <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
                              <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">],</span>
                              <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span>
                              <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span>
                              <span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">],</span>
                             <span class="p">]</span>
                            <span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">test_argument</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">slope</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">data.preprocessing_helpers</span> <span class="kn">import</span> <span class="n">preprocess</span>
<span class="kn">from</span> <span class="nn">features.as_numpy</span> <span class="kn">import</span> <span class="n">get_data_as_numpy_array</span>
<span class="kn">from</span> <span class="nn">models.train</span> <span class="kn">import</span> <span class="p">(</span><span class="n">split_into_training_and_testing_sets</span><span class="p">,</span> <span class="n">train_model</span><span class="p">)</span>

<span class="n">preprocess</span><span class="p">(</span><span class="s">"data/raw/housing_data.txt"</span><span class="p">,</span><span class="s">"data/clean/clean_housing_data.txt"</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">get_data_as_numpy_array</span><span class="p">(</span><span class="s">"data/clean/clean_housing_data.txt"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">training_set</span><span class="p">,</span> <span class="n">testing_set</span> <span class="o">=</span> <span class="p">(</span><span class="n">split_into_training_and_testing_sets</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">training_set</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="testing-model-performance">Testing model performance</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">model_test</span><span class="p">(</span><span class="n">testing_set</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>
    <span class="s">"""Return r^2 of fit"""</span>
</code></pre></div></div>

<h4 id="plotting-function">Plotting function</h4>

<p align="center"><img src="/images/post_img/unittest13.PNG" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_plot_for_best_fit_line</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">y_array</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="s">"""
    slope: slope of best fit line
    intercept: intercept of best fit line
    x_array: array containing housing areas
    y_array: array containing housing prices
    """</span>
</code></pre></div></div>

<p>ë‹¤ìŒ plots.pyë¥¼ ìœ„ì˜ ì‚¬ì§„ì²˜ëŸ¼ ê²½ë¡œë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì </p>

<h4 id="trainingtesting-plot">training/testing plot</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">visualization</span> <span class="kn">import</span> <span class="n">get_plot_for_best_fit_line</span>
<span class="n">preprocess</span><span class="p">(...)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">get_data_as_numpy_array</span><span class="p">(...)</span>
<span class="n">training_set</span><span class="p">,</span> <span class="n">testing_set</span> <span class="o">=</span> <span class="p">(</span><span class="n">split_into_training_and_testing_sets</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">training_set</span><span class="p">)</span>
<span class="n">get_plot_for_best_fit_line</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span>
                           <span class="n">training_set</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">training_set</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="s">"Training"</span><span class="p">)</span>

<span class="n">get_plot_for_best_fit_line</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span>
                           <span class="n">testing_set</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">testing_set</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="s">"Testing"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="pytest-mpl">pytest-mpl</h4>

<p><code class="language-plaintext highlighter-rouge">pip install pytest-mpl</code> ë¥¼ í†µí•´ì„œ install</p>

<h4 id="example">example</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">visualization</span> <span class="kn">import</span> <span class="n">get_plot_for_best_fit_line</span>
<span class="k">def</span> <span class="nf">test_plot_for_linear_data</span><span class="p">():</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span><span class="c1"># Linear data set    
</span>    <span class="n">y_array</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">])</span>    
    <span class="n">title</span> <span class="o">=</span> <span class="s">"Test plot for linear data"</span>
    <span class="k">return</span> <span class="n">get_plot_for_best_fit_line</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">y_array</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span>pytest <span class="nt">-k</span> <span class="s2">"test_plot_for_linear_data"</span> <span class="nt">--mpl-generate-path</span> visualization/baseline
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span>pytest <span class="nt">-k</span> <span class="s2">"test_plot_for_linear_data"</span> <span class="nt">--mpl</span>
</code></pre></div></div>

:ET